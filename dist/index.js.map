{"version":3,"sources":["../src/event_listener.ts","../src/dispatcher.ts","../src/action_descriptor.ts","../src/action.ts","../src/binding.ts","../src/element_observer.ts","../src/attribute_observer.ts","../src/string_map_observer.ts","../src/set_operations.ts","../src/multimap.ts","../src/indexed_multimap.ts","../src/index.ts","../src/token_list_observer.ts","../src/value_list_observer.ts","../src/binding_observer.ts","../src/value_observer.ts","../src/context.ts","../src/inheritable_statics.ts","../src/blessing.ts","../src/definition.ts","../src/module.ts","../src/class_map.ts","../src/string_helpers.ts","../src/data_map.ts","../src/guide.ts","../src/selectors.ts","../src/target_set.ts","../src/scope.ts","../src/scope_observer.ts","../src/router.ts","../src/schema.ts","../src/application.ts","../src/class_properties.ts","../src/target_properties.ts","../src/value_properties.ts","../src/controller.ts","../../../node_modules/stimulus/index.js","../src/polyfills/custom-elements-native-shim.ts","../src/polyfills/submit-event.ts","../src/elements/frame_element.ts","../src/http/fetch_request.ts","../src/core/drive/form_submission.ts","../src/core/drive/visit.ts","../src/core/url.ts","../src/http/fetch_response.ts","../src/util.ts","../src/observers/appearance_observer.ts","../src/core/streams/stream_message.ts","../src/core/snapshot.ts","../src/core/frames/form_interceptor.ts","../src/core/view.ts","../src/core/frames/frame_view.ts","../src/core/frames/link_interceptor.ts","../src/core/bardo.ts","../src/core/renderer.ts","../src/core/frames/frame_renderer.ts","../src/core/drive/progress_bar.ts","../src/core/drive/head_snapshot.ts","../src/core/drive/page_snapshot.ts","../src/observers/page_observer.ts","../src/core/native/browser_adapter.ts","../src/observers/form_submit_observer.ts","../src/core/frames/frame_redirector.ts","../src/core/drive/history.ts","../src/observers/link_click_observer.ts","../src/core/types.ts","../src/core/drive/navigator.ts","../src/observers/scroll_observer.ts","../src/observers/stream_observer.ts","../src/core/drive/error_renderer.ts","../src/core/drive/page_renderer.ts","../src/core/drive/snapshot_cache.ts","../src/core/drive/page_view.ts","../src/core/session.ts","../src/core/frames/frame_controller.ts","../src/core/streams/stream_actions.ts","../src/elements/stream_element.ts","../src/elements/index.ts","../src/script_warning.ts","../src/core/index.ts","todo/index.ts","todos/index.ts","index.ts"],"names":[],"mappings":"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","file":"index.js","sourceRoot":"../src/client/contollers","sourcesContent":["import { Binding } from \"./binding\"\n\nexport class EventListener implements EventListenerObject {\n  readonly eventTarget: EventTarget\n  readonly eventName: string\n  readonly eventOptions: AddEventListenerOptions\n  private unorderedBindings: Set<Binding>\n\n  constructor(eventTarget: EventTarget, eventName: string, eventOptions: AddEventListenerOptions) {\n    this.eventTarget = eventTarget\n    this.eventName = eventName\n    this.eventOptions = eventOptions\n    this.unorderedBindings = new Set()\n  }\n\n  connect() {\n    this.eventTarget.addEventListener(this.eventName, this, this.eventOptions)\n  }\n\n  disconnect() {\n    this.eventTarget.removeEventListener(this.eventName, this, this.eventOptions)\n  }\n\n  // Binding observer delegate\n\n  /** @hidden */\n  bindingConnected(binding: Binding) {\n    this.unorderedBindings.add(binding)\n  }\n\n  /** @hidden */\n  bindingDisconnected(binding: Binding) {\n    this.unorderedBindings.delete(binding)\n  }\n\n  handleEvent(event: Event) {\n    const extendedEvent = extendEvent(event)\n    for (const binding of this.bindings) {\n      if (extendedEvent.immediatePropagationStopped) {\n        break\n      } else {\n        binding.handleEvent(extendedEvent)\n      }\n    }\n  }\n\n  get bindings(): Binding[] {\n    return Array.from(this.unorderedBindings).sort((left, right) => {\n      const leftIndex = left.index, rightIndex = right.index\n      return leftIndex < rightIndex ? -1 : leftIndex > rightIndex ? 1 : 0\n    })\n  }\n\n}\n\nfunction extendEvent(event: Event) {\n  if (\"immediatePropagationStopped\" in event) {\n    return event\n  } else {\n    const { stopImmediatePropagation } = event\n    return Object.assign(event, {\n      immediatePropagationStopped: false,\n      stopImmediatePropagation() {\n        this.immediatePropagationStopped = true\n        stopImmediatePropagation.call(this)\n      }\n    })\n  }\n}\n","import { Application } from \"./application\"\nimport { Binding } from \"./binding\"\nimport { BindingObserverDelegate } from \"./binding_observer\"\nimport { EventListener } from \"./event_listener\"\n\nexport class Dispatcher implements BindingObserverDelegate {\n  readonly application: Application\n  private eventListenerMaps: Map<EventTarget, Map<string, EventListener>>\n  private started: boolean\n\n  constructor(application: Application) {\n    this.application = application\n    this.eventListenerMaps = new Map\n    this.started = false\n  }\n\n  start() {\n    if (!this.started) {\n      this.started = true\n      this.eventListeners.forEach(eventListener => eventListener.connect())\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      this.started = false\n      this.eventListeners.forEach(eventListener => eventListener.disconnect())\n    }\n  }\n\n  get eventListeners(): EventListener[] {\n    return Array.from(this.eventListenerMaps.values())\n      .reduce((listeners, map) => listeners.concat(Array.from(map.values())), [] as EventListener[])\n  }\n\n  // Binding observer delegate\n\n  /** @hidden */\n  bindingConnected(binding: Binding) {\n    this.fetchEventListenerForBinding(binding).bindingConnected(binding)\n  }\n\n  /** @hidden */\n  bindingDisconnected(binding: Binding) {\n    this.fetchEventListenerForBinding(binding).bindingDisconnected(binding)\n  }\n\n  // Error handling\n\n  handleError(error: Error, message: string, detail: object = {}) {\n    this.application.handleError(error, `Error ${message}`, detail)\n  }\n\n  private fetchEventListenerForBinding(binding: Binding): EventListener {\n    const { eventTarget, eventName, eventOptions } = binding\n    return this.fetchEventListener(eventTarget, eventName, eventOptions)\n  }\n\n  private fetchEventListener(eventTarget: EventTarget, eventName: string, eventOptions: AddEventListenerOptions): EventListener {\n    const eventListenerMap = this.fetchEventListenerMapForEventTarget(eventTarget)\n    const cacheKey = this.cacheKey(eventName, eventOptions)\n    let eventListener = eventListenerMap.get(cacheKey)\n    if (!eventListener) {\n      eventListener = this.createEventListener(eventTarget, eventName, eventOptions)\n      eventListenerMap.set(cacheKey, eventListener)\n    }\n    return eventListener\n  }\n\n  private createEventListener(eventTarget: EventTarget, eventName: string, eventOptions: AddEventListenerOptions): EventListener {\n    const eventListener = new EventListener(eventTarget, eventName, eventOptions)\n    if (this.started) {\n      eventListener.connect()\n    }\n    return eventListener\n  }\n\n  private fetchEventListenerMapForEventTarget(eventTarget: EventTarget): Map<string, EventListener> {\n    let eventListenerMap = this.eventListenerMaps.get(eventTarget)\n    if (!eventListenerMap) {\n      eventListenerMap = new Map\n      this.eventListenerMaps.set(eventTarget, eventListenerMap)\n    }\n    return eventListenerMap\n  }\n\n  private cacheKey(eventName: string, eventOptions: any): string {\n    const parts = [ eventName ]\n    Object.keys(eventOptions).sort().forEach(key => {\n      parts.push(`${eventOptions[key] ? \"\" : \"!\"}${key}`)\n    })\n    return parts.join(\":\")\n  }\n}\n","export interface ActionDescriptor {\n  eventTarget: EventTarget\n  eventOptions: AddEventListenerOptions\n  eventName: string\n  identifier: string\n  methodName: string\n}\n\n// capture nos.:            12   23 4               43   1 5   56 7      768 9  98\nconst descriptorPattern = /^((.+?)(@(window|document))?->)?(.+?)(#([^:]+?))(:(.+))?$/\n\nexport function parseActionDescriptorString(descriptorString: string): Partial<ActionDescriptor> {\n  const source = descriptorString.trim()\n  const matches = source.match(descriptorPattern) || []\n  return {\n    eventTarget:  parseEventTarget(matches[4]),\n    eventName:    matches[2],\n    eventOptions: matches[9] ? parseEventOptions(matches[9]) : {},\n    identifier:   matches[5],\n    methodName:   matches[7]\n  }\n}\n\nfunction parseEventTarget(eventTargetName: string): EventTarget | undefined {\n  if (eventTargetName == \"window\") {\n    return window\n  } else if (eventTargetName == \"document\") {\n    return document\n  }\n}\n\nfunction parseEventOptions(eventOptions: string): AddEventListenerOptions {\n  return eventOptions.split(\":\").reduce((options, token) =>\n    Object.assign(options, { [token.replace(/^!/, \"\")]: !/^!/.test(token) })\n  , {})\n}\n\nexport function stringifyEventTarget(eventTarget: EventTarget) {\n  if (eventTarget == window) {\n    return \"window\"\n  } else if (eventTarget == document) {\n    return \"document\"\n  }\n}\n","import { ActionDescriptor, parseActionDescriptorString, stringifyEventTarget } from \"./action_descriptor\"\nimport { Token } from \"@stimulus/mutation-observers\"\n\nexport class Action {\n  readonly element: Element\n  readonly index: number\n  readonly eventTarget: EventTarget\n  readonly eventName: string\n  readonly eventOptions: AddEventListenerOptions\n  readonly identifier: string\n  readonly methodName: string\n\n  static forToken(token: Token) {\n    return new this(token.element, token.index, parseActionDescriptorString(token.content))\n  }\n\n  constructor(element: Element, index: number, descriptor: Partial<ActionDescriptor>) {\n    this.element      = element\n    this.index        = index\n    this.eventTarget  = descriptor.eventTarget || element\n    this.eventName    = descriptor.eventName || getDefaultEventNameForElement(element) || error(\"missing event name\")\n    this.eventOptions = descriptor.eventOptions || {}\n    this.identifier   = descriptor.identifier || error(\"missing identifier\")\n    this.methodName   = descriptor.methodName || error(\"missing method name\")\n  }\n\n  toString() {\n    const eventNameSuffix = this.eventTargetName ? `@${this.eventTargetName}` : \"\"\n    return `${this.eventName}${eventNameSuffix}->${this.identifier}#${this.methodName}`\n  }\n\n  private get eventTargetName() {\n    return stringifyEventTarget(this.eventTarget)\n  }\n}\n\nconst defaultEventNames: { [tagName: string]: (element: Element) => string } = {\n  \"a\":        e => \"click\",\n  \"button\":   e => \"click\",\n  \"form\":     e => \"submit\",\n  \"input\":    e => e.getAttribute(\"type\") == \"submit\" ? \"click\" : \"input\",\n  \"select\":   e => \"change\",\n  \"textarea\": e => \"input\"\n}\n\nexport function getDefaultEventNameForElement(element: Element): string | undefined {\n  const tagName = element.tagName.toLowerCase()\n  if (tagName in defaultEventNames) {\n    return defaultEventNames[tagName](element)\n  }\n}\n\nfunction error(message: string): never {\n  throw new Error(message)\n}\n","import { Action } from \"./action\"\nimport { Context } from \"./context\"\nimport { Controller } from \"./controller\"\nimport { Scope } from \"./scope\"\n\nexport class Binding {\n  readonly context: Context\n  readonly action: Action\n\n  constructor(context: Context, action: Action) {\n    this.context = context\n    this.action = action\n  }\n\n  get index(): number {\n    return this.action.index\n  }\n\n  get eventTarget(): EventTarget {\n    return this.action.eventTarget\n  }\n\n  get eventOptions(): AddEventListenerOptions {\n    return this.action.eventOptions\n  }\n\n  get identifier(): string {\n    return this.context.identifier\n  }\n\n  handleEvent(event: Event) {\n    if (this.willBeInvokedByEvent(event)) {\n      this.invokeWithEvent(event)\n    }\n  }\n\n  get eventName(): string {\n    return this.action.eventName\n  }\n\n  get method(): Function {\n    const method = (this.controller as any)[this.methodName]\n    if (typeof method == \"function\") {\n      return method\n    }\n    throw new Error(`Action \"${this.action}\" references undefined method \"${this.methodName}\"`)\n  }\n\n  private invokeWithEvent(event: Event) {\n    try {\n      this.method.call(this.controller, event)\n    } catch (error) {\n      const { identifier, controller, element, index } = this\n      const detail = { identifier, controller, element, index, event }\n      this.context.handleError(error, `invoking action \"${this.action}\"`, detail)\n    }\n  }\n\n  private willBeInvokedByEvent(event: Event): boolean {\n    const eventTarget = event.target\n    if (this.element === eventTarget) {\n      return true\n    } else if (eventTarget instanceof Element && this.element.contains(eventTarget)) {\n      return this.scope.containsElement(eventTarget)\n    } else {\n      return this.scope.containsElement(this.action.element)\n    }\n  }\n\n  private get controller(): Controller {\n    return this.context.controller\n  }\n\n  private get methodName(): string {\n    return this.action.methodName\n  }\n\n  private get element(): Element {\n    return this.scope.element\n  }\n\n  private get scope(): Scope {\n    return this.context.scope\n  }\n}\n","export interface ElementObserverDelegate {\n  matchElement(element: Element): boolean\n  matchElementsInTree(tree: Element): Element[]\n\n  elementMatched?(element: Element): void\n  elementUnmatched?(element: Element): void\n  elementAttributeChanged?(element: Element, attributeName: string): void\n}\n\nexport class ElementObserver {\n  element: Element\n  started: boolean\n  private delegate: ElementObserverDelegate\n\n  private elements: Set<Element>\n  private mutationObserver: MutationObserver\n\n  constructor(element: Element, delegate: ElementObserverDelegate) {\n    this.element = element\n    this.started = false\n    this.delegate = delegate\n\n    this.elements = new Set\n    this.mutationObserver = new MutationObserver((mutations) => this.processMutations(mutations))\n  }\n\n  start() {\n    if (!this.started) {\n      this.started = true\n      this.mutationObserver.observe(this.element, { attributes: true, childList: true, subtree: true })\n      this.refresh()\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      this.mutationObserver.takeRecords()\n      this.mutationObserver.disconnect()\n      this.started = false\n    }\n  }\n\n  refresh() {\n    if (this.started) {\n      const matches = new Set(this.matchElementsInTree())\n\n      for (const element of Array.from(this.elements)) {\n        if (!matches.has(element)) {\n          this.removeElement(element)\n        }\n      }\n\n      for (const element of Array.from(matches)) {\n        this.addElement(element)\n      }\n    }\n  }\n\n  // Mutation record processing\n\n  private processMutations(mutations: MutationRecord[]) {\n    if (this.started) {\n      for (const mutation of mutations) {\n        this.processMutation(mutation)\n      }\n    }\n  }\n\n  private processMutation(mutation: MutationRecord) {\n    if (mutation.type == \"attributes\") {\n      this.processAttributeChange(mutation.target, mutation.attributeName!)\n    } else if (mutation.type == \"childList\") {\n      this.processRemovedNodes(mutation.removedNodes)\n      this.processAddedNodes(mutation.addedNodes)\n    }\n  }\n\n  private processAttributeChange(node: Node, attributeName: string) {\n    const element = node as Element\n    if (this.elements.has(element)) {\n      if (this.delegate.elementAttributeChanged && this.matchElement(element)) {\n        this.delegate.elementAttributeChanged(element, attributeName)\n      } else {\n        this.removeElement(element)\n      }\n    } else if (this.matchElement(element)) {\n      this.addElement(element)\n    }\n  }\n\n  private processRemovedNodes(nodes: NodeList) {\n    for (const node of Array.from(nodes)) {\n      const element = this.elementFromNode(node)\n      if (element) {\n        this.processTree(element, this.removeElement)\n      }\n    }\n  }\n\n  private processAddedNodes(nodes: NodeList) {\n    for (const node of Array.from(nodes)) {\n      const element = this.elementFromNode(node)\n      if (element && this.elementIsActive(element)) {\n        this.processTree(element, this.addElement)\n      }\n    }\n  }\n\n  // Element matching\n\n  private matchElement(element: Element): boolean {\n    return this.delegate.matchElement(element)\n  }\n\n  private matchElementsInTree(tree: Element = this.element): Element[] {\n    return this.delegate.matchElementsInTree(tree)\n  }\n\n  private processTree(tree: Element, processor: (element: Element) => void) {\n    for (const element of this.matchElementsInTree(tree)) {\n      processor.call(this, element)\n    }\n  }\n\n  private elementFromNode(node: Node): Element | undefined {\n    if (node.nodeType == Node.ELEMENT_NODE) {\n      return node as Element\n    }\n  }\n\n  private elementIsActive(element: Element): boolean {\n    if (element.isConnected != this.element.isConnected) {\n      return false\n    } else {\n      return this.element.contains(element)\n    }\n  }\n\n  // Element tracking\n\n  private addElement(element: Element) {\n    if (!this.elements.has(element)) {\n      if (this.elementIsActive(element)) {\n        this.elements.add(element)\n        if (this.delegate.elementMatched) {\n          this.delegate.elementMatched(element)\n        }\n      }\n    }\n  }\n\n  private removeElement(element: Element) {\n    if (this.elements.has(element)) {\n      this.elements.delete(element)\n      if (this.delegate.elementUnmatched) {\n        this.delegate.elementUnmatched(element)\n      }\n    }\n  }\n}\n","import { ElementObserver, ElementObserverDelegate } from \"./element_observer\"\n\nexport interface AttributeObserverDelegate {\n  elementMatchedAttribute?(element: Element, attributeName: string): void\n  elementAttributeValueChanged?(element: Element, attributeName: string): void\n  elementUnmatchedAttribute?(element: Element, attributeName: string): void\n}\n\nexport class AttributeObserver implements ElementObserverDelegate {\n  attributeName: string\n  private delegate: AttributeObserverDelegate\n\n  private elementObserver: ElementObserver\n\n  constructor(element: Element, attributeName: string, delegate: AttributeObserverDelegate) {\n    this.attributeName = attributeName\n    this.delegate = delegate\n\n    this.elementObserver = new ElementObserver(element, this)\n  }\n\n  get element(): Element {\n    return this.elementObserver.element\n  }\n\n  get selector(): string {\n    return `[${this.attributeName}]`\n  }\n\n  start() {\n    this.elementObserver.start()\n  }\n\n  stop() {\n    this.elementObserver.stop()\n  }\n\n  refresh() {\n    this.elementObserver.refresh()\n  }\n\n  get started(): boolean {\n    return this.elementObserver.started\n  }\n\n  // Element observer delegate\n\n  matchElement(element: Element): boolean {\n    return element.hasAttribute(this.attributeName)\n  }\n\n  matchElementsInTree(tree: Element): Element[] {\n    const match = this.matchElement(tree) ? [tree] : []\n    const matches = Array.from(tree.querySelectorAll(this.selector))\n    return match.concat(matches)\n  }\n\n  elementMatched(element: Element) {\n    if (this.delegate.elementMatchedAttribute) {\n      this.delegate.elementMatchedAttribute(element, this.attributeName)\n    }\n  }\n\n  elementUnmatched(element: Element) {\n    if (this.delegate.elementUnmatchedAttribute) {\n      this.delegate.elementUnmatchedAttribute(element, this.attributeName)\n    }\n  }\n\n  elementAttributeChanged(element: Element, attributeName: string) {\n    if (this.delegate.elementAttributeValueChanged && this.attributeName == attributeName) {\n      this.delegate.elementAttributeValueChanged(element, attributeName)\n    }\n  }\n}\n","export interface StringMapObserverDelegate {\n  getStringMapKeyForAttribute(attributeName: string): string | undefined\n  stringMapKeyAdded?(key: string, attributeName: string): void\n  stringMapValueChanged?(value: string | null, key: string): void\n  stringMapKeyRemoved?(key: string, attributeName: string): void\n}\n\nexport class StringMapObserver {\n  readonly element: Element\n  readonly delegate: StringMapObserverDelegate\n  private started: boolean\n  private stringMap: Map<string, string>\n  private mutationObserver: MutationObserver\n\n  constructor(element: Element, delegate: StringMapObserverDelegate) {\n    this.element = element\n    this.delegate = delegate\n    this.started = false\n    this.stringMap = new Map\n    this.mutationObserver = new MutationObserver(mutations => this.processMutations(mutations))\n  }\n\n  start() {\n    if (!this.started) {\n      this.started = true\n      this.mutationObserver.observe(this.element, { attributes: true })\n      this.refresh()\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      this.mutationObserver.takeRecords()\n      this.mutationObserver.disconnect()\n      this.started = false\n    }\n  }\n\n  refresh() {\n    if (this.started) {\n      for (const attributeName of this.knownAttributeNames) {\n        this.refreshAttribute(attributeName)\n      }\n    }\n  }\n\n  // Mutation record processing\n\n  private processMutations(mutations: MutationRecord[]) {\n    if (this.started) {\n      for (const mutation of mutations) {\n        this.processMutation(mutation)\n      }\n    }\n  }\n\n  private processMutation(mutation: MutationRecord) {\n    const attributeName = mutation.attributeName\n    if (attributeName) {\n      this.refreshAttribute(attributeName)\n    }\n  }\n\n  // State tracking\n\n  private refreshAttribute(attributeName: string) {\n    const key = this.delegate.getStringMapKeyForAttribute(attributeName)\n    if (key != null) {\n      if (!this.stringMap.has(attributeName)) {\n        this.stringMapKeyAdded(key, attributeName)\n      }\n\n      const value = this.element.getAttribute(attributeName)\n      if (this.stringMap.get(attributeName) != value) {\n        this.stringMapValueChanged(value, key)\n      }\n\n      if (value == null) {\n        this.stringMap.delete(attributeName)\n        this.stringMapKeyRemoved(key, attributeName)\n      } else {\n        this.stringMap.set(attributeName, value)\n      }\n    }\n  }\n\n  private stringMapKeyAdded(key: string, attributeName: string) {\n    if (this.delegate.stringMapKeyAdded) {\n      this.delegate.stringMapKeyAdded(key, attributeName)\n    }\n  }\n\n  private stringMapValueChanged(value: string | null, key: string) {\n    if (this.delegate.stringMapValueChanged) {\n      this.delegate.stringMapValueChanged(value, key)\n    }\n  }\n\n  private stringMapKeyRemoved(key: string, attributeName: string) {\n    if (this.delegate.stringMapKeyRemoved) {\n      this.delegate.stringMapKeyRemoved(key, attributeName)\n    }\n  }\n\n  private get knownAttributeNames() {\n    return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))\n  }\n\n  private get currentAttributeNames() {\n    return Array.from(this.element.attributes).map(attribute => attribute.name)\n  }\n\n  private get recordedAttributeNames() {\n    return Array.from(this.stringMap.keys())\n  }\n}\n","export function add<K, V>(map: Map<K, Set<V>>, key: K, value: V) {\n  fetch(map, key).add(value)\n}\n\nexport function del<K, V>(map: Map<K, Set<V>>, key: K, value: V) {\n  fetch(map, key).delete(value)\n  prune(map, key)\n}\n\nexport function fetch<K, V>(map: Map<K, Set<V>>, key: K): Set<V> {\n  let values = map.get(key)\n  if (!values) {\n    values = new Set()\n    map.set(key, values)\n  }\n  return values\n}\n\nexport function prune<K, V>(map: Map<K, Set<V>>, key: K) {\n  const values = map.get(key)\n  if (values != null && values.size == 0) {\n    map.delete(key)\n  }\n}\n","import { add, del } from \"./set_operations\"\n\nexport class Multimap<K, V> {\n  private valuesByKey: Map<K, Set<V>>\n\n  constructor() {\n    this.valuesByKey = new Map<K, Set<V>>()\n  }\n\n  get values(): V[] {\n    const sets = Array.from(this.valuesByKey.values())\n    return sets.reduce((values, set) => values.concat(Array.from(set)), <V[]> [])\n  }\n\n  get size(): number {\n    const sets = Array.from(this.valuesByKey.values())\n    return sets.reduce((size, set) => size + set.size, 0)\n  }\n\n  add(key: K, value: V) {\n    add(this.valuesByKey, key, value)\n  }\n\n  delete(key: K, value: V) {\n    del(this.valuesByKey, key, value)\n  }\n\n  has(key: K, value: V): boolean {\n    const values = this.valuesByKey.get(key)\n    return values != null && values.has(value)\n  }\n\n  hasKey(key: K): boolean {\n    return this.valuesByKey.has(key)\n  }\n\n  hasValue(value: V): boolean {\n    const sets = Array.from(this.valuesByKey.values())\n    return sets.some(set => set.has(value))\n  }\n\n  getValuesForKey(key: K): V[] {\n    const values = this.valuesByKey.get(key)\n    return values ? Array.from(values) : []\n  }\n\n  getKeysForValue(value: V): K[] {\n    return Array.from(this.valuesByKey)\n      .filter(([key, values]) => values.has(value))\n      .map(([key, values]) => key)\n  }\n}\n","import { Multimap } from \"./multimap\"\nimport { add, del } from \"./set_operations\"\n\nexport class IndexedMultimap<K, V> extends Multimap<K, V> {\n  private keysByValue: Map<V, Set<K>>\n\n  constructor() {\n    super()\n    this.keysByValue = new Map\n  }\n\n  get values(): V[] {\n    return Array.from(this.keysByValue.keys())\n  }\n\n  add(key: K, value: V) {\n    super.add(key, value)\n    add(this.keysByValue, value, key)\n  }\n\n  delete(key: K, value: V) {\n    super.delete(key, value)\n    del(this.keysByValue, value, key)\n  }\n\n  hasValue(value: V): boolean {\n    return this.keysByValue.has(value)\n  }\n\n  getKeysForValue(value: V): K[] {\n    const set = this.keysByValue.get(value)\n    return set ? Array.from(set) : []\n  }\n}\n","export * from \"./indexed_multimap\"\nexport * from \"./multimap\"\nexport * from \"./set_operations\"\n","import { AttributeObserver, AttributeObserverDelegate } from \"./attribute_observer\"\nimport { Multimap } from \"@stimulus/multimap\"\n\nexport interface Token {\n  element: Element\n  attributeName: string\n  index: number\n  content: string\n}\n\nexport interface TokenListObserverDelegate {\n  tokenMatched(token: Token): void\n  tokenUnmatched(token: Token): void\n}\n\nexport class TokenListObserver implements AttributeObserverDelegate {\n  private attributeObserver: AttributeObserver\n  private delegate: TokenListObserverDelegate\n  private tokensByElement: Multimap<Element, Token>\n\n  constructor(element: Element, attributeName: string, delegate: TokenListObserverDelegate) {\n    this.attributeObserver = new AttributeObserver(element, attributeName, this)\n    this.delegate = delegate\n    this.tokensByElement = new Multimap\n  }\n\n  get started(): boolean {\n    return this.attributeObserver.started\n  }\n\n  start() {\n    this.attributeObserver.start()\n  }\n\n  stop() {\n    this.attributeObserver.stop()\n  }\n\n  refresh() {\n    this.attributeObserver.refresh()\n  }\n\n  get element(): Element {\n    return this.attributeObserver.element\n  }\n\n  get attributeName(): string {\n    return this.attributeObserver.attributeName\n  }\n\n  // Attribute observer delegate\n\n  elementMatchedAttribute(element: Element) {\n    this.tokensMatched(this.readTokensForElement(element))\n  }\n\n  elementAttributeValueChanged(element: Element) {\n    const [unmatchedTokens, matchedTokens] = this.refreshTokensForElement(element)\n    this.tokensUnmatched(unmatchedTokens)\n    this.tokensMatched(matchedTokens)\n  }\n\n  elementUnmatchedAttribute(element: Element) {\n    this.tokensUnmatched(this.tokensByElement.getValuesForKey(element))\n  }\n\n  private tokensMatched(tokens: Token[]) {\n    tokens.forEach(token => this.tokenMatched(token))\n  }\n\n  private tokensUnmatched(tokens: Token[]) {\n    tokens.forEach(token => this.tokenUnmatched(token))\n  }\n\n  private tokenMatched(token: Token) {\n    this.delegate.tokenMatched(token)\n    this.tokensByElement.add(token.element, token)\n  }\n\n  private tokenUnmatched(token: Token) {\n    this.delegate.tokenUnmatched(token)\n    this.tokensByElement.delete(token.element, token)\n  }\n\n  private refreshTokensForElement(element: Element): [Token[], Token[]] {\n    const previousTokens = this.tokensByElement.getValuesForKey(element)\n    const currentTokens = this.readTokensForElement(element)\n    const firstDifferingIndex = zip(previousTokens, currentTokens)\n      .findIndex(([previousToken, currentToken]) => !tokensAreEqual(previousToken, currentToken))\n\n    if (firstDifferingIndex == -1) {\n      return [[], []]\n    } else {\n      return [previousTokens.slice(firstDifferingIndex), currentTokens.slice(firstDifferingIndex)]\n    }\n  }\n\n  private readTokensForElement(element: Element): Token[] {\n    const attributeName = this.attributeName\n    const tokenString = element.getAttribute(attributeName) || \"\"\n    return parseTokenString(tokenString, element, attributeName)\n  }\n}\n\nfunction parseTokenString(tokenString: string, element: Element, attributeName: string): Token[] {\n  return tokenString.trim().split(/\\s+/).filter(content => content.length)\n    .map((content, index) => ({ element, attributeName, content, index }))\n}\n\nfunction zip<L, R>(left: L[], right: R[]): [L | undefined, R | undefined][] {\n  const length = Math.max(left.length, right.length)\n  return Array.from({ length }, (_, index) => [left[index], right[index]] as [L, R])\n}\n\nfunction tokensAreEqual(left?: Token, right?: Token) {\n  return left && right && left.index == right.index && left.content == right.content\n}\n","import { Token, TokenListObserver, TokenListObserverDelegate } from \"./token_list_observer\"\n\nexport interface ValueListObserverDelegate<T> {\n  parseValueForToken(token: Token): T | undefined\n  elementMatchedValue(element: Element, value: T): void\n  elementUnmatchedValue(element: Element, value: T): void\n}\n\ninterface ParseResult<T> {\n  value?: T\n  error?: Error\n}\n\nexport class ValueListObserver<T> implements TokenListObserverDelegate {\n  private tokenListObserver: TokenListObserver\n  private delegate: ValueListObserverDelegate<T>\n  private parseResultsByToken: WeakMap<Token, ParseResult<T>>\n  private valuesByTokenByElement: WeakMap<Element, Map<Token, T>>\n\n  constructor(element: Element, attributeName: string, delegate: ValueListObserverDelegate<T>) {\n    this.tokenListObserver = new TokenListObserver(element, attributeName, this)\n    this.delegate = delegate\n    this.parseResultsByToken = new WeakMap\n    this.valuesByTokenByElement = new WeakMap\n  }\n\n  get started(): boolean {\n    return this.tokenListObserver.started\n  }\n\n  start() {\n    this.tokenListObserver.start()\n  }\n\n  stop() {\n    this.tokenListObserver.stop()\n  }\n\n  refresh() {\n    this.tokenListObserver.refresh()\n  }\n\n  get element(): Element {\n    return this.tokenListObserver.element\n  }\n\n  get attributeName(): string {\n    return this.tokenListObserver.attributeName\n  }\n\n  tokenMatched(token: Token) {\n    const { element } = token\n    const { value } = this.fetchParseResultForToken(token)\n    if (value) {\n      this.fetchValuesByTokenForElement(element).set(token, value)\n      this.delegate.elementMatchedValue(element, value)\n    }\n  }\n\n  tokenUnmatched(token: Token) {\n    const { element } = token\n    const { value } = this.fetchParseResultForToken(token)\n    if (value) {\n      this.fetchValuesByTokenForElement(element).delete(token)\n      this.delegate.elementUnmatchedValue(element, value)\n    }\n  }\n\n  private fetchParseResultForToken(token: Token) {\n    let parseResult = this.parseResultsByToken.get(token)\n    if (!parseResult) {\n      parseResult = this.parseToken(token)\n      this.parseResultsByToken.set(token, parseResult)\n    }\n    return parseResult\n  }\n\n  private fetchValuesByTokenForElement(element: Element) {\n    let valuesByToken = this.valuesByTokenByElement.get(element)\n    if (!valuesByToken) {\n      valuesByToken = new Map\n      this.valuesByTokenByElement.set(element, valuesByToken)\n    }\n    return valuesByToken\n  }\n\n  private parseToken(token: Token): ParseResult<T> {\n    try {\n      const value = this.delegate.parseValueForToken(token)\n      return { value }\n    } catch (error) {\n      return { error }\n    }\n  }\n}\n","import { Action } from \"./action\"\nimport { Binding } from \"./binding\"\nimport { Context } from \"./context\"\nimport { ErrorHandler } from \"./error_handler\"\nimport { Schema } from \"./schema\"\nimport { Token, ValueListObserver, ValueListObserverDelegate } from \"@stimulus/mutation-observers\"\n\nexport interface BindingObserverDelegate extends ErrorHandler {\n  bindingConnected(binding: Binding): void\n  bindingDisconnected(binding: Binding): void\n}\n\nexport class BindingObserver implements ValueListObserverDelegate<Action> {\n  readonly context: Context\n  private delegate: BindingObserverDelegate\n  private valueListObserver?: ValueListObserver<Action>\n  private bindingsByAction: Map<Action, Binding>\n\n  constructor(context: Context, delegate: BindingObserverDelegate) {\n    this.context = context\n    this.delegate = delegate\n    this.bindingsByAction = new Map\n  }\n\n  start() {\n    if (!this.valueListObserver) {\n      this.valueListObserver = new ValueListObserver(this.element, this.actionAttribute, this)\n      this.valueListObserver.start()\n    }\n  }\n\n  stop() {\n    if (this.valueListObserver) {\n      this.valueListObserver.stop()\n      delete this.valueListObserver\n      this.disconnectAllActions()\n    }\n  }\n\n  get element() {\n    return this.context.element\n  }\n\n  get identifier() {\n    return this.context.identifier\n  }\n\n  get actionAttribute() {\n    return this.schema.actionAttribute\n  }\n\n  get schema(): Schema {\n    return this.context.schema\n  }\n\n  get bindings(): Binding[] {\n    return Array.from(this.bindingsByAction.values())\n  }\n\n  private connectAction(action: Action) {\n    const binding = new Binding(this.context, action)\n    this.bindingsByAction.set(action, binding)\n    this.delegate.bindingConnected(binding)\n  }\n\n  private disconnectAction(action: Action) {\n    const binding = this.bindingsByAction.get(action)\n    if (binding) {\n      this.bindingsByAction.delete(action)\n      this.delegate.bindingDisconnected(binding)\n    }\n  }\n\n  private disconnectAllActions() {\n    this.bindings.forEach(binding => this.delegate.bindingDisconnected(binding))\n    this.bindingsByAction.clear()\n  }\n\n  // Value observer delegate\n\n  parseValueForToken(token: Token): Action | undefined {\n    const action = Action.forToken(token)\n    if (action.identifier == this.identifier) {\n      return action\n    }\n  }\n\n  elementMatchedValue(element: Element, action: Action) {\n    this.connectAction(action)\n  }\n\n  elementUnmatchedValue(element: Element, action: Action) {\n    this.disconnectAction(action)\n  }\n}\n","import { Context } from \"./context\"\nimport { StringMapObserver, StringMapObserverDelegate } from \"@stimulus/mutation-observers\"\nimport { ValueDescriptor } from \"./value_properties\"\n\nexport class ValueObserver implements StringMapObserverDelegate {\n  readonly context: Context\n  readonly receiver: any\n  private stringMapObserver: StringMapObserver\n  private valueDescriptorMap: { [attributeName: string]: ValueDescriptor }\n\n  constructor(context: Context, receiver: any) {\n    this.context = context\n    this.receiver = receiver\n    this.stringMapObserver = new StringMapObserver(this.element, this)\n    this.valueDescriptorMap = (this.controller as any).valueDescriptorMap\n    this.invokeChangedCallbacksForDefaultValues()\n  }\n\n  start() {\n    this.stringMapObserver.start()\n  }\n\n  stop() {\n    this.stringMapObserver.stop()\n  }\n\n  get element() {\n    return this.context.element\n  }\n\n  get controller() {\n    return this.context.controller\n  }\n\n  // String map observer delegate\n\n  getStringMapKeyForAttribute(attributeName: string) {\n    if (attributeName in this.valueDescriptorMap) {\n      return this.valueDescriptorMap[attributeName].name\n    }\n  }\n\n  stringMapValueChanged(attributeValue: string | null, name: string) {\n    this.invokeChangedCallbackForValue(name)\n  }\n\n  private invokeChangedCallbacksForDefaultValues() {\n    for (const { key, name, defaultValue } of this.valueDescriptors) {\n      if (defaultValue != undefined && !this.controller.data.has(key)) {\n        this.invokeChangedCallbackForValue(name)\n      }\n    }\n  }\n\n  private invokeChangedCallbackForValue(name: string) {\n    const methodName = `${name}Changed`\n    const method = this.receiver[methodName]\n    if (typeof method == \"function\") {\n      const value = this.receiver[name]\n      method.call(this.receiver, value)\n    }\n  }\n\n  private get valueDescriptors() {\n    const { valueDescriptorMap } = this\n    return Object.keys(valueDescriptorMap).map(key => valueDescriptorMap[key])\n  }\n}\n","import { Application } from \"./application\"\nimport { BindingObserver } from \"./binding_observer\"\nimport { Controller } from \"./controller\"\nimport { Dispatcher } from \"./dispatcher\"\nimport { ErrorHandler } from \"./error_handler\"\nimport { Module } from \"./module\"\nimport { Schema } from \"./schema\"\nimport { Scope } from \"./scope\"\nimport { ValueObserver } from \"./value_observer\"\n\nexport class Context implements ErrorHandler {\n  readonly module: Module\n  readonly scope: Scope\n  readonly controller: Controller\n  private bindingObserver: BindingObserver\n  private valueObserver: ValueObserver\n\n  constructor(module: Module, scope: Scope) {\n    this.module = module\n    this.scope = scope\n    this.controller = new module.controllerConstructor(this)\n    this.bindingObserver = new BindingObserver(this, this.dispatcher)\n    this.valueObserver = new ValueObserver(this, this.controller)\n\n    try {\n      this.controller.initialize()\n    } catch (error) {\n      this.handleError(error, \"initializing controller\")\n    }\n  }\n\n  connect() {\n    this.bindingObserver.start()\n    this.valueObserver.start()\n\n    try {\n      this.controller.connect()\n    } catch (error) {\n      this.handleError(error, \"connecting controller\")\n    }\n  }\n\n  disconnect() {\n    try {\n      this.controller.disconnect()\n    } catch (error) {\n      this.handleError(error, \"disconnecting controller\")\n    }\n\n    this.valueObserver.stop()\n    this.bindingObserver.stop()\n  }\n\n  get application(): Application {\n    return this.module.application\n  }\n\n  get identifier(): string {\n    return this.module.identifier\n  }\n\n  get schema(): Schema {\n    return this.application.schema\n  }\n\n  get dispatcher(): Dispatcher {\n    return this.application.dispatcher\n  }\n\n  get element(): Element {\n    return this.scope.element\n  }\n\n  get parentElement(): Element | null {\n    return this.element.parentElement\n  }\n\n  // Error handling\n\n  handleError(error: Error, message: string, detail: object = {}) {\n    const { identifier, controller, element } = this\n    detail = Object.assign({ identifier, controller, element }, detail)\n    this.application.handleError(error, `Error ${message}`, detail)\n  }\n}\n","import { Constructor } from \"./constructor\"\n\nexport function readInheritableStaticArrayValues<T, U = string>(constructor: Constructor<T>, propertyName: string) {\n  const ancestors = getAncestorsForConstructor(constructor)\n  return Array.from(ancestors.reduce((values, constructor) => {\n    getOwnStaticArrayValues(constructor, propertyName).forEach(name => values.add(name))\n    return values\n  }, new Set as Set<U>))\n}\n\nexport function readInheritableStaticObjectPairs<T, U>(constructor: Constructor<T>, propertyName: string) {\n  const ancestors = getAncestorsForConstructor(constructor)\n  return ancestors.reduce((pairs, constructor) => {\n    pairs.push(...getOwnStaticObjectPairs(constructor, propertyName) as any)\n    return pairs\n  }, [] as [string, U][])\n}\n\nfunction getAncestorsForConstructor<T>(constructor: Constructor<T>) {\n  const ancestors: Constructor<{}>[] = []\n  while (constructor) {\n    ancestors.push(constructor)\n    constructor = Object.getPrototypeOf(constructor)\n  }\n  return ancestors.reverse()\n}\n\nfunction getOwnStaticArrayValues<T>(constructor: Constructor<T>, propertyName: string) {\n  const definition = (constructor as any)[propertyName]\n  return Array.isArray(definition) ? definition : []\n}\n\nfunction getOwnStaticObjectPairs<T, U>(constructor: Constructor<T>, propertyName: string) {\n  const definition = (constructor as any)[propertyName]\n  return definition ? Object.keys(definition).map(key => [key, definition[key]] as [string, U]) : []\n}\n","import { Constructor } from \"./constructor\"\nimport { readInheritableStaticArrayValues } from \"./inheritable_statics\"\n\n/** @hidden */\nexport type Blessing<T> = (constructor: Constructor<T>) => PropertyDescriptorMap\n\n/** @hidden */\nexport interface Blessable<T> extends Constructor<T> {\n  readonly blessings?: Blessing<T>[]\n}\n\n/** @hidden */\nexport function bless<T>(constructor: Blessable<T>): Constructor<T> {\n  return shadow(constructor, getBlessedProperties(constructor))\n}\n\nfunction shadow<T>(constructor: Constructor<T>, properties: PropertyDescriptorMap) {\n  const shadowConstructor = extend(constructor)\n  const shadowProperties = getShadowProperties(constructor.prototype, properties)\n  Object.defineProperties(shadowConstructor.prototype, shadowProperties)\n  return shadowConstructor\n}\n\nfunction getBlessedProperties<T>(constructor: Constructor<T>) {\n  const blessings = readInheritableStaticArrayValues(constructor, \"blessings\") as Blessing<T>[]\n  return blessings.reduce((blessedProperties, blessing) => {\n    const properties = blessing(constructor)\n    for (const key in properties) {\n      const descriptor = blessedProperties[key] || {} as PropertyDescriptor\n      blessedProperties[key] = Object.assign(descriptor, properties[key])\n    }\n    return blessedProperties\n  }, {} as PropertyDescriptorMap)\n}\n\nfunction getShadowProperties<T>(prototype: any, properties: PropertyDescriptorMap) {\n  return getOwnKeys(properties).reduce((shadowProperties, key) => {\n    const descriptor = getShadowedDescriptor(prototype, properties, key)\n    if (descriptor) {\n      Object.assign(shadowProperties, { [key]: descriptor })\n    }\n    return shadowProperties\n  }, {} as PropertyDescriptorMap)\n}\n\nfunction getShadowedDescriptor(prototype: any, properties: PropertyDescriptorMap, key: string | symbol) {\n  const shadowingDescriptor = Object.getOwnPropertyDescriptor(prototype, key)\n  const shadowedByValue = shadowingDescriptor && \"value\" in shadowingDescriptor\n  if (!shadowedByValue) {\n    const descriptor = Object.getOwnPropertyDescriptor(properties, key)!.value\n    if (shadowingDescriptor) {\n      descriptor.get = shadowingDescriptor.get || descriptor.get\n      descriptor.set = shadowingDescriptor.set || descriptor.set\n    }\n    return descriptor\n  }\n}\n\nconst getOwnKeys = (() => {\n  if (typeof Object.getOwnPropertySymbols == \"function\") {\n    return (object: any) => [\n      ...Object.getOwnPropertyNames(object),\n      ...Object.getOwnPropertySymbols(object)\n    ]\n  } else {\n    return Object.getOwnPropertyNames\n  }\n})()\n\nconst extend = (() => {\n  function extendWithReflect<T extends Constructor<{}>>(constructor: T): T {\n    function extended() {\n      return Reflect.construct(constructor, arguments, new.target)\n    }\n\n    extended.prototype = Object.create(constructor.prototype, {\n      constructor: { value: extended }\n    })\n\n    Reflect.setPrototypeOf(extended, constructor)\n    return extended as any\n  }\n\n  function testReflectExtension() {\n    const a = function(this: any) { this.a.call(this) } as any\n    const b = extendWithReflect(a)\n    b.prototype.a = function() {}\n    return new b\n  }\n\n  try {\n    testReflectExtension()\n    return extendWithReflect\n  } catch (error) {\n    return <T extends Constructor<{}>>(constructor: T) => class extended extends constructor {}\n  }\n})()\n","import { bless } from \"./blessing\"\nimport { ControllerConstructor } from \"./controller\"\n\nexport interface Definition {\n  identifier: string\n  controllerConstructor: ControllerConstructor\n}\n\n/** @hidden */\nexport function blessDefinition(definition: Definition): Definition {\n  return {\n    identifier: definition.identifier,\n    controllerConstructor: bless(definition.controllerConstructor)\n  }\n}\n","import { Application } from \"./application\"\nimport { Context } from \"./context\"\nimport { ControllerConstructor } from \"./controller\"\nimport { Definition, blessDefinition } from \"./definition\"\nimport { Scope } from \"./scope\"\n\nexport class Module {\n  readonly application: Application\n  readonly definition: Definition\n  private contextsByScope: WeakMap<Scope, Context>\n  private connectedContexts: Set<Context>\n\n  constructor(application: Application, definition: Definition) {\n    this.application = application\n    this.definition = blessDefinition(definition)\n    this.contextsByScope = new WeakMap\n    this.connectedContexts = new Set\n  }\n\n  get identifier(): string {\n    return this.definition.identifier\n  }\n\n  get controllerConstructor(): ControllerConstructor {\n    return this.definition.controllerConstructor\n  }\n\n  get contexts(): Context[] {\n    return Array.from(this.connectedContexts)\n  }\n\n  connectContextForScope(scope: Scope) {\n    const context = this.fetchContextForScope(scope)\n    this.connectedContexts.add(context)\n    context.connect()\n  }\n\n  disconnectContextForScope(scope: Scope) {\n    const context = this.contextsByScope.get(scope)\n    if (context) {\n      this.connectedContexts.delete(context)\n      context.disconnect()\n    }\n  }\n\n  private fetchContextForScope(scope: Scope): Context {\n    let context = this.contextsByScope.get(scope)\n    if (!context) {\n      context = new Context(this, scope)\n      this.contextsByScope.set(scope, context)\n    }\n    return context\n  }\n}\n","import { Scope } from \"./scope\"\n\nexport class ClassMap {\n  readonly scope: Scope\n\n  constructor(scope: Scope) {\n    this.scope = scope\n  }\n\n  has(name: string) {\n    return this.data.has(this.getDataKey(name))\n  }\n\n  get(name: string) {\n    return this.data.get(this.getDataKey(name))\n  }\n\n  getAttributeName(name: string) {\n    return this.data.getAttributeNameForKey(this.getDataKey(name))\n  }\n\n  getDataKey(name: string) {\n    return `${name}-class`\n  }\n\n  get data() {\n    return this.scope.data\n  }\n}\n","export function camelize(value: string) {\n  return value.replace(/(?:[_-])([a-z0-9])/g, (_, char) => char.toUpperCase())\n}\n\nexport function capitalize(value: string) {\n  return value.charAt(0).toUpperCase() + value.slice(1)\n}\n\nexport function dasherize(value: string) {\n  return value.replace(/([A-Z])/g, (_, char) => `-${char.toLowerCase()}`)\n}\n","import { Scope } from \"./scope\"\nimport { dasherize } from \"./string_helpers\"\n\nexport class DataMap {\n  readonly scope: Scope\n\n  constructor(scope: Scope) {\n    this.scope = scope\n  }\n\n  get element(): Element {\n    return this.scope.element\n  }\n\n  get identifier(): string {\n    return this.scope.identifier\n  }\n\n  get(key: string): string | null {\n    const name = this.getAttributeNameForKey(key)\n    return this.element.getAttribute(name)\n  }\n\n  set(key: string, value: string): string | null {\n    const name = this.getAttributeNameForKey(key)\n    this.element.setAttribute(name, value)\n    return this.get(key)\n  }\n\n  has(key: string): boolean {\n    const name = this.getAttributeNameForKey(key)\n    return this.element.hasAttribute(name)\n  }\n\n  delete(key: string): boolean {\n    if (this.has(key)) {\n      const name = this.getAttributeNameForKey(key)\n      this.element.removeAttribute(name)\n      return true\n    } else {\n      return false\n    }\n  }\n\n  getAttributeNameForKey(key: string): string {\n    return `data-${this.identifier}-${dasherize(key)}`\n  }\n}\n","import { Logger } from \"./logger\"\n\nexport class Guide {\n  readonly logger: Logger\n  readonly warnedKeysByObject: WeakMap<any, Set<string>> = new WeakMap\n\n  constructor(logger: Logger) {\n    this.logger = logger\n  }\n\n  warn(object: any, key: string, message: string) {\n    let warnedKeys: Set<string> | undefined = this.warnedKeysByObject.get(object)\n\n    if (!warnedKeys) {\n      warnedKeys = new Set\n      this.warnedKeysByObject.set(object, warnedKeys)\n    }\n\n    if (!warnedKeys.has(key)) {\n      warnedKeys.add(key)\n      this.logger.warn(message, object)\n    }\n  }\n}\n","/** @hidden */\nexport function attributeValueContainsToken(attributeName: string, token: string) {\n  return `[${attributeName}~=\"${token}\"]`\n}\n","import { Scope } from \"./scope\"\nimport { attributeValueContainsToken } from \"./selectors\"\n\nexport class TargetSet {\n  readonly scope: Scope\n\n  constructor(scope: Scope) {\n    this.scope = scope\n  }\n\n  get element() {\n    return this.scope.element\n  }\n\n  get identifier() {\n    return this.scope.identifier\n  }\n\n  get schema() {\n    return this.scope.schema\n  }\n\n  has(targetName: string) {\n    return this.find(targetName) != null\n  }\n\n  find(...targetNames: string[]) {\n    return targetNames.reduce((target, targetName) =>\n         target\n      || this.findTarget(targetName)\n      || this.findLegacyTarget(targetName)\n    , undefined as Element | undefined)\n  }\n\n  findAll(...targetNames: string[]) {\n    return targetNames.reduce((targets, targetName) => [\n      ...targets,\n      ...this.findAllTargets(targetName),\n      ...this.findAllLegacyTargets(targetName)\n    ], [] as Element[])\n  }\n\n  private findTarget(targetName: string) {\n    const selector = this.getSelectorForTargetName(targetName)\n    return this.scope.findElement(selector)\n  }\n\n  private findAllTargets(targetName: string) {\n    const selector = this.getSelectorForTargetName(targetName)\n    return this.scope.findAllElements(selector)\n  }\n\n  private getSelectorForTargetName(targetName: string) {\n    const attributeName = `data-${this.identifier}-target`\n    return attributeValueContainsToken(attributeName, targetName)\n  }\n\n  private findLegacyTarget(targetName: string) {\n    const selector = this.getLegacySelectorForTargetName(targetName)\n    return this.deprecate(this.scope.findElement(selector), targetName)\n  }\n\n  private findAllLegacyTargets(targetName: string) {\n    const selector = this.getLegacySelectorForTargetName(targetName)\n    return this.scope.findAllElements(selector).map(element => this.deprecate(element, targetName))\n  }\n\n  private getLegacySelectorForTargetName(targetName: string) {\n    const targetDescriptor = `${this.identifier}.${targetName}`\n    return attributeValueContainsToken(this.schema.targetAttribute, targetDescriptor)\n  }\n\n  private deprecate<T>(element: T, targetName: string) {\n    if (element) {\n      const { identifier } = this\n      const attributeName = this.schema.targetAttribute\n      this.guide.warn(element, `target:${targetName}`,\n        `Please replace ${attributeName}=\"${identifier}.${targetName}\" with data-${identifier}-target=\"${targetName}\". ` +\n        `The ${attributeName} attribute is deprecated and will be removed in a future version of Stimulus.`)\n    }\n    return element\n  }\n\n  private get guide() {\n    return this.scope.guide\n  }\n}\n","import { ClassMap } from \"./class_map\"\nimport { DataMap } from \"./data_map\"\nimport { Guide } from \"./guide\"\nimport { Logger } from \"./logger\"\nimport { Schema } from \"./schema\"\nimport { attributeValueContainsToken } from \"./selectors\"\nimport { TargetSet } from \"./target_set\"\n\nexport class Scope {\n  readonly schema: Schema\n  readonly element: Element\n  readonly identifier: string\n  readonly guide: Guide\n  readonly targets = new TargetSet(this)\n  readonly classes = new ClassMap(this)\n  readonly data = new DataMap(this)\n\n  constructor(schema: Schema, element: Element, identifier: string, logger: Logger) {\n    this.schema = schema\n    this.element = element\n    this.identifier = identifier\n    this.guide = new Guide(logger)\n  }\n\n  findElement(selector: string): Element | undefined {\n    return this.element.matches(selector)\n      ? this.element\n      : this.queryElements(selector).find(this.containsElement)\n  }\n\n  findAllElements(selector: string): Element[] {\n    return [\n      ...this.element.matches(selector) ? [this.element] : [],\n      ...this.queryElements(selector).filter(this.containsElement)\n    ]\n  }\n\n  containsElement = (element: Element): boolean => {\n    return element.closest(this.controllerSelector) === this.element\n  }\n\n  private queryElements(selector: string): Element[] {\n    return Array.from(this.element.querySelectorAll(selector))\n  }\n\n  private get controllerSelector(): string {\n    return attributeValueContainsToken(this.schema.controllerAttribute, this.identifier)\n  }\n}\n","import { ErrorHandler } from \"./error_handler\"\nimport { Schema } from \"./schema\"\nimport { Scope } from \"./scope\"\nimport { Token, ValueListObserver, ValueListObserverDelegate } from \"@stimulus/mutation-observers\"\n\nexport interface ScopeObserverDelegate extends ErrorHandler {\n  createScopeForElementAndIdentifier(element: Element, identifier: string): Scope\n  scopeConnected(scope: Scope): void\n  scopeDisconnected(scope: Scope): void\n}\n\nexport class ScopeObserver implements ValueListObserverDelegate<Scope> {\n  readonly element: Element\n  readonly schema: Schema\n  private delegate: ScopeObserverDelegate\n  private valueListObserver: ValueListObserver<Scope>\n  private scopesByIdentifierByElement: WeakMap<Element, Map<string, Scope>>\n  private scopeReferenceCounts: WeakMap<Scope, number>\n\n  constructor(element: Element, schema: Schema, delegate: ScopeObserverDelegate) {\n    this.element = element\n    this.schema = schema\n    this.delegate = delegate\n    this.valueListObserver = new ValueListObserver(this.element, this.controllerAttribute, this)\n    this.scopesByIdentifierByElement = new WeakMap\n    this.scopeReferenceCounts = new WeakMap\n  }\n\n  start() {\n    this.valueListObserver.start()\n  }\n\n  stop() {\n    this.valueListObserver.stop()\n  }\n\n  get controllerAttribute() {\n    return this.schema.controllerAttribute\n  }\n\n  // Value observer delegate\n\n  /** @hidden */\n  parseValueForToken(token: Token): Scope | undefined {\n    const { element, content: identifier } = token\n    const scopesByIdentifier = this.fetchScopesByIdentifierForElement(element)\n\n    let scope = scopesByIdentifier.get(identifier)\n    if (!scope) {\n      scope = this.delegate.createScopeForElementAndIdentifier(element, identifier)\n      scopesByIdentifier.set(identifier, scope)\n    }\n\n    return scope\n  }\n\n  /** @hidden */\n  elementMatchedValue(element: Element, value: Scope) {\n    const referenceCount = (this.scopeReferenceCounts.get(value) || 0) + 1\n    this.scopeReferenceCounts.set(value, referenceCount)\n    if (referenceCount == 1) {\n      this.delegate.scopeConnected(value)\n    }\n  }\n\n  /** @hidden */\n  elementUnmatchedValue(element: Element, value: Scope) {\n    const referenceCount = this.scopeReferenceCounts.get(value)\n    if (referenceCount) {\n      this.scopeReferenceCounts.set(value, referenceCount - 1)\n      if (referenceCount == 1) {\n        this.delegate.scopeDisconnected(value)\n      }\n    }\n  }\n\n  private fetchScopesByIdentifierForElement(element: Element) {\n    let scopesByIdentifier = this.scopesByIdentifierByElement.get(element)\n    if (!scopesByIdentifier) {\n      scopesByIdentifier = new Map\n      this.scopesByIdentifierByElement.set(element, scopesByIdentifier)\n    }\n    return scopesByIdentifier\n  }\n}\n","import { Application } from \"./application\"\nimport { Context } from \"./context\"\nimport { Definition } from \"./definition\"\nimport { Module } from \"./module\"\nimport { Multimap } from \"@stimulus/multimap\"\nimport { Scope } from \"./scope\"\nimport { ScopeObserver, ScopeObserverDelegate } from \"./scope_observer\"\n\nexport class Router implements ScopeObserverDelegate {\n  readonly application: Application\n  private scopeObserver: ScopeObserver\n  private scopesByIdentifier: Multimap<string, Scope>\n  private modulesByIdentifier: Map<string, Module>\n\n  constructor(application: Application) {\n    this.application = application\n    this.scopeObserver = new ScopeObserver(this.element, this.schema, this)\n    this.scopesByIdentifier = new Multimap\n    this.modulesByIdentifier = new Map\n  }\n\n  get element() {\n    return this.application.element\n  }\n\n  get schema() {\n    return this.application.schema\n  }\n\n  get logger() {\n    return this.application.logger\n  }\n\n  get controllerAttribute(): string {\n    return this.schema.controllerAttribute\n  }\n\n  get modules() {\n    return Array.from(this.modulesByIdentifier.values())\n  }\n\n  get contexts() {\n    return this.modules.reduce((contexts, module) => contexts.concat(module.contexts), [] as Context[])\n  }\n\n  start() {\n    this.scopeObserver.start()\n  }\n\n  stop() {\n    this.scopeObserver.stop()\n  }\n\n  loadDefinition(definition: Definition) {\n    this.unloadIdentifier(definition.identifier)\n    const module = new Module(this.application, definition)\n    this.connectModule(module)\n  }\n\n  unloadIdentifier(identifier: string) {\n    const module = this.modulesByIdentifier.get(identifier)\n    if (module) {\n      this.disconnectModule(module)\n    }\n  }\n\n  getContextForElementAndIdentifier(element: Element, identifier: string) {\n    const module = this.modulesByIdentifier.get(identifier)\n    if (module) {\n      return module.contexts.find(context => context.element == element)\n    }\n  }\n\n  // Error handler delegate\n\n  /** @hidden */\n  handleError(error: Error, message: string, detail: any) {\n    this.application.handleError(error, message, detail)\n  }\n\n  // Scope observer delegate\n\n  /** @hidden */\n  createScopeForElementAndIdentifier(element: Element, identifier: string) {\n    return new Scope(this.schema, element, identifier, this.logger)\n  }\n\n  /** @hidden */\n  scopeConnected(scope: Scope) {\n    this.scopesByIdentifier.add(scope.identifier, scope)\n    const module = this.modulesByIdentifier.get(scope.identifier)\n    if (module) {\n      module.connectContextForScope(scope)\n    }\n  }\n\n  /** @hidden */\n  scopeDisconnected(scope: Scope) {\n    this.scopesByIdentifier.delete(scope.identifier, scope)\n    const module = this.modulesByIdentifier.get(scope.identifier)\n    if (module) {\n      module.disconnectContextForScope(scope)\n    }\n  }\n\n  // Modules\n\n  private connectModule(module: Module) {\n    this.modulesByIdentifier.set(module.identifier, module)\n    const scopes = this.scopesByIdentifier.getValuesForKey(module.identifier)\n    scopes.forEach(scope => module.connectContextForScope(scope))\n  }\n\n  private disconnectModule(module: Module) {\n    this.modulesByIdentifier.delete(module.identifier)\n    const scopes = this.scopesByIdentifier.getValuesForKey(module.identifier)\n    scopes.forEach(scope => module.disconnectContextForScope(scope))\n  }\n}\n","export interface Schema {\n  controllerAttribute: string\n  actionAttribute: string\n  targetAttribute: string\n}\n\nexport const defaultSchema: Schema = {\n  controllerAttribute: \"data-controller\",\n  actionAttribute: \"data-action\",\n  targetAttribute: \"data-target\"\n}\n","import { Controller, ControllerConstructor } from \"./controller\"\nimport { Definition } from \"./definition\"\nimport { Dispatcher } from \"./dispatcher\"\nimport { ErrorHandler } from \"./error_handler\"\nimport { Logger } from \"./logger\"\nimport { Router } from \"./router\"\nimport { Schema, defaultSchema } from \"./schema\"\n\nexport class Application implements ErrorHandler {\n  readonly element: Element\n  readonly schema: Schema\n  readonly dispatcher: Dispatcher\n  readonly router: Router\n  logger: Logger = console\n\n  static start(element?: Element, schema?: Schema): Application {\n    const application = new Application(element, schema)\n    application.start()\n    return application\n  }\n\n  constructor(element: Element = document.documentElement, schema: Schema = defaultSchema) {\n    this.element = element\n    this.schema = schema\n    this.dispatcher = new Dispatcher(this)\n    this.router = new Router(this)\n  }\n\n  async start() {\n    await domReady()\n    this.dispatcher.start()\n    this.router.start()\n  }\n\n  stop() {\n    this.dispatcher.stop()\n    this.router.stop()\n  }\n\n  register(identifier: string, controllerConstructor: ControllerConstructor) {\n    this.load({ identifier, controllerConstructor })\n  }\n\n  load(...definitions: Definition[]): void\n  load(definitions: Definition[]): void\n  load(head: Definition | Definition[], ...rest: Definition[]) {\n    const definitions = Array.isArray(head) ? head : [head, ...rest]\n    definitions.forEach(definition => this.router.loadDefinition(definition))\n  }\n\n  unload(...identifiers: string[]): void\n  unload(identifiers: string[]): void\n  unload(head: string | string[], ...rest: string[]) {\n    const identifiers = Array.isArray(head) ? head : [head, ...rest]\n    identifiers.forEach(identifier => this.router.unloadIdentifier(identifier))\n  }\n\n  // Controllers\n\n  get controllers(): Controller[] {\n    return this.router.contexts.map(context => context.controller)\n  }\n\n  getControllerForElementAndIdentifier(element: Element, identifier: string): Controller | null {\n    const context = this.router.getContextForElementAndIdentifier(element, identifier)\n    return context ? context.controller : null\n  }\n\n  // Error handling\n\n  handleError(error: Error, message: string, detail: object) {\n    this.logger.error(`%s\\n\\n%o\\n\\n%o`, message, error, detail)\n  }\n}\n\nfunction domReady(): Promise<any> {\n  return new Promise(resolve => {\n    if (document.readyState == \"loading\") {\n      document.addEventListener(\"DOMContentLoaded\", resolve)\n    } else {\n      resolve()\n    }\n  })\n}\n","import { Constructor } from \"./constructor\"\nimport { Controller } from \"./controller\"\nimport { readInheritableStaticArrayValues } from \"./inheritable_statics\"\nimport { capitalize } from \"./string_helpers\"\n\n/** @hidden */\nexport function ClassPropertiesBlessing<T>(constructor: Constructor<T>) {\n  const classes = readInheritableStaticArrayValues(constructor, \"classes\")\n  return classes.reduce((properties, classDefinition) => {\n    return Object.assign(properties, propertiesForClassDefinition(classDefinition))\n  }, {} as PropertyDescriptorMap)\n}\n\nfunction propertiesForClassDefinition(key: string) {\n  const name = `${key}Class`\n\n  return {\n    [name]: {\n      get(this: Controller) {\n        const { classes } = this\n        if (classes.has(key)) {\n          return classes.get(key)\n        } else {\n          const attribute = classes.getAttributeName(key)\n          throw new Error(`Missing attribute \"${attribute}\"`)\n        }\n      }\n    },\n\n    [`has${capitalize(name)}`]: {\n      get(this: Controller) {\n        return this.classes.has(key)\n      }\n    }\n  }\n}\n","import { Constructor } from \"./constructor\"\nimport { Controller } from \"./controller\"\nimport { readInheritableStaticArrayValues } from \"./inheritable_statics\"\nimport { capitalize } from \"./string_helpers\"\n\n/** @hidden */\nexport function TargetPropertiesBlessing<T>(constructor: Constructor<T>) {\n  const targets = readInheritableStaticArrayValues(constructor, \"targets\")\n  return targets.reduce((properties, targetDefinition) => {\n    return Object.assign(properties, propertiesForTargetDefinition(targetDefinition))\n  }, {} as PropertyDescriptorMap)\n}\n\nfunction propertiesForTargetDefinition(name: string) {\n  return {\n    [`${name}Target`]: {\n      get(this: Controller) {\n        const target = this.targets.find(name)\n        if (target) {\n          return target\n        } else {\n          throw new Error(`Missing target element \"${this.identifier}.${name}\"`)\n        }\n      }\n    },\n\n    [`${name}Targets`]: {\n      get(this: Controller) {\n        return this.targets.findAll(name)\n      }\n    },\n\n    [`has${capitalize(name)}Target`]: {\n      get(this: Controller) {\n        return this.targets.has(name)\n      }\n    }\n  }\n}\n","import { Constructor } from \"./constructor\"\nimport { Controller } from \"./controller\"\nimport { readInheritableStaticObjectPairs } from \"./inheritable_statics\"\nimport { camelize, capitalize, dasherize } from \"./string_helpers\"\n\n/** @hidden */\nexport function ValuePropertiesBlessing<T>(constructor: Constructor<T>) {\n  const valueDefinitionPairs = readInheritableStaticObjectPairs<T, ValueTypeConstant>(constructor, \"values\")\n  const propertyDescriptorMap: PropertyDescriptorMap = {\n    valueDescriptorMap: {\n      get(this: Controller) {\n        return valueDefinitionPairs.reduce((result, valueDefinitionPair) => {\n          const valueDescriptor = parseValueDefinitionPair(valueDefinitionPair)\n          const attributeName = this.data.getAttributeNameForKey(valueDescriptor.key)\n          return Object.assign(result, { [attributeName]: valueDescriptor })\n        }, {} as ValueDescriptorMap)\n      }\n    }\n  }\n\n  return valueDefinitionPairs.reduce((properties, valueDefinitionPair) => {\n    return Object.assign(properties, propertiesForValueDefinitionPair(valueDefinitionPair))\n  }, propertyDescriptorMap)\n}\n\n/** @hidden */\nexport function propertiesForValueDefinitionPair<T>(valueDefinitionPair: ValueDefinitionPair): PropertyDescriptorMap {\n  const definition = parseValueDefinitionPair(valueDefinitionPair)\n  const { type, key, name } = definition\n  const read = readers[type], write = writers[type] || writers.default\n\n  return {\n    [name]: {\n      get(this: Controller) {\n        const value = this.data.get(key)\n        if (value !== null) {\n          return read(value)\n        } else {\n          return definition.defaultValue\n        }\n      },\n\n      set(this: Controller, value: T | undefined) {\n        if (value === undefined) {\n          this.data.delete(key)\n        } else {\n          this.data.set(key, write(value))\n        }\n      }\n    },\n\n    [`has${capitalize(name)}`]: {\n      get(this: Controller): boolean {\n        return this.data.has(key)\n      }\n    }\n  }\n}\n\nexport type ValueDescriptor = {\n  type: ValueType,\n  key: string,\n  name: string,\n  defaultValue: any\n}\n\nexport type ValueDescriptorMap = { [attributeName: string]: ValueDescriptor }\n\nexport type ValueDefinitionMap = { [token: string]: ValueTypeConstant }\n\nexport type ValueDefinitionPair = [string, ValueTypeConstant]\n\nexport type ValueTypeConstant = typeof Array | typeof Boolean | typeof Number | typeof Object | typeof String\n\nexport type ValueType = \"array\" | \"boolean\" | \"number\" | \"object\" | \"string\"\n\nfunction parseValueDefinitionPair([token, typeConstant]: ValueDefinitionPair): ValueDescriptor {\n  const type = parseValueTypeConstant(typeConstant)\n  return valueDescriptorForTokenAndType(token, type)\n}\n\nfunction parseValueTypeConstant(typeConstant: ValueTypeConstant) {\n  switch (typeConstant) {\n    case Array:   return \"array\"\n    case Boolean: return \"boolean\"\n    case Number:  return \"number\"\n    case Object:  return \"object\"\n    case String:  return \"string\"\n  }\n  throw new Error(`Unknown value type constant \"${typeConstant}\"`)\n}\n\nfunction valueDescriptorForTokenAndType(token: string, type: ValueType) {\n  const key = `${dasherize(token)}-value`\n  return {\n    type,\n    key,\n    name: camelize(key),\n    get defaultValue() { return defaultValuesByType[type] }\n  }\n}\n\nconst defaultValuesByType = {\n  get array() { return [] },\n  boolean: false,\n  number: 0,\n  get object() { return {} },\n  string: \"\"\n}\n\ntype Reader = (value: string) => any\n\nconst readers: { [type: string]: Reader } = {\n  array(value: string): any[] {\n    const array = JSON.parse(value)\n    if (!Array.isArray(array)) {\n      throw new TypeError(\"Expected array\")\n    }\n    return array\n  },\n\n  boolean(value: string): boolean {\n    return !(value == \"0\" || value == \"false\")\n  },\n\n  number(value: string): number {\n    return parseFloat(value)\n  },\n\n  object(value: string): object {\n    const object = JSON.parse(value)\n    if (object === null || typeof object != \"object\" || Array.isArray(object)) {\n      throw new TypeError(\"Expected object\")\n    }\n    return object\n  },\n\n  string(value: string): string {\n    return value\n  }\n}\n\ntype Writer = (value: any) => string\n\nconst writers: { [type: string]: Writer } = {\n  default: writeString,\n  array: writeJSON,\n  object: writeJSON\n}\n\nfunction writeJSON(value: any) {\n  return JSON.stringify(value)\n}\n\nfunction writeString(value: any) {\n  return `${value}`\n}\n","import { ClassPropertiesBlessing } from \"./class_properties\"\nimport { Constructor } from \"./constructor\"\nimport { Context } from \"./context\"\nimport { TargetPropertiesBlessing } from \"./target_properties\"\nimport { ValuePropertiesBlessing, ValueDefinitionMap } from \"./value_properties\"\n\nexport type ControllerConstructor = Constructor<Controller>\n\nexport class Controller {\n  static blessings = [ ClassPropertiesBlessing, TargetPropertiesBlessing, ValuePropertiesBlessing ]\n  static targets: string[] = []\n  static values: ValueDefinitionMap = {}\n\n  readonly context: Context\n\n  constructor(context: Context) {\n    this.context = context\n  }\n\n  get application() {\n    return this.context.application\n  }\n\n  get scope() {\n    return this.context.scope\n  }\n\n  get element() {\n    return this.scope.element\n  }\n\n  get identifier() {\n    return this.scope.identifier\n  }\n\n  get targets() {\n    return this.scope.targets\n  }\n\n  get classes() {\n    return this.scope.classes\n  }\n\n  get data() {\n    return this.scope.data\n  }\n\n  initialize() {\n    // Override in your subclass to set up initial controller state\n  }\n\n  connect() {\n    // Override in your subclass to respond when the controller is connected to the DOM\n  }\n\n  disconnect() {\n    // Override in your subclass to respond when the controller is disconnected from the DOM\n  }\n}\n","export * from \"@stimulus/core\"\n","/**\n * @license\n * Copyright (c) 2016 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt The complete set of authors may be found\n * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may\n * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by\n * Google as part of the polymer project is also subject to an additional IP\n * rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * This shim allows elements written in, or compiled to, ES5 to work on native\n * implementations of Custom Elements v1. It sets new.target to the value of\n * this.constructor so that the native HTMLElement constructor can access the\n * current under-construction element's definition.\n */\n(function() {\n  if (\n      // No Reflect, no classes, no need for shim because native custom elements\n      // require ES2015 classes or Reflect.\n      window.Reflect === undefined || window.customElements === undefined ||\n      // The webcomponentsjs custom elements polyfill doesn't require\n      // ES2015-compatible construction (`super()` or `Reflect.construct`).\n      (window.customElements as any).polyfillWrapFlushCallback) {\n    return;\n  }\n  const BuiltInHTMLElement = HTMLElement;\n\n  /**\n   * With jscompiler's RECOMMENDED_FLAGS the function name will be optimized away.\n   * However, if we declare the function as a property on an object literal, and\n   * use quotes for the property name, then closure will leave that much intact,\n   * which is enough for the JS VM to correctly set Function.prototype.name.\n   */\n  const wrapperForTheName = {\n    'HTMLElement': function HTMLElement(this: HTMLElement) {\n      return Reflect.construct(BuiltInHTMLElement, [], this.constructor);\n    }\n  };\n  window.HTMLElement =\n      wrapperForTheName['HTMLElement'] as unknown as typeof HTMLElement;\n  HTMLElement.prototype = BuiltInHTMLElement.prototype;\n  HTMLElement.prototype.constructor = HTMLElement;\n  Object.setPrototypeOf(HTMLElement, BuiltInHTMLElement);\n  })();\n","type FormSubmitter = HTMLElement & { form?: HTMLFormElement, type?: string }\n\nconst submittersByForm: WeakMap<HTMLFormElement, HTMLElement> = new WeakMap\n\nfunction findSubmitterFromClickTarget(target: EventTarget | null): FormSubmitter | null {\n  const element = target instanceof Element ? target : target instanceof Node ? target.parentElement : null\n  const candidate = element ? element.closest(\"input, button\") as FormSubmitter | null : null\n  return candidate?.type == \"submit\" ? candidate : null\n}\n\nfunction clickCaptured(event: Event) {\n  const submitter = findSubmitterFromClickTarget(event.target)\n\n  if (submitter && submitter.form) {\n    submittersByForm.set(submitter.form, submitter)\n  }\n}\n\n(function() {\n  if (\"SubmitEvent\" in window) return\n\n  addEventListener(\"click\", clickCaptured, true)\n\n  Object.defineProperty(Event.prototype, \"submitter\", {\n    get(): HTMLElement | undefined {\n      if (this.type == \"submit\" && this.target instanceof HTMLFormElement) {\n        return submittersByForm.get(this.target)\n      }\n    }\n  })\n})()\n","import { FetchResponse } from \"../http/fetch_response\"\n\nexport enum FrameLoadingStyle { eager = \"eager\", lazy = \"lazy\" }\n\nexport interface FrameElementDelegate {\n  connect(): void\n  disconnect(): void\n  loadingStyleChanged(): void\n  sourceURLChanged(): void\n  disabledChanged(): void\n  formSubmissionIntercepted(element: HTMLFormElement, submitter?: HTMLElement): void\n  loadResponse(response: FetchResponse): void\n  isLoading: boolean\n}\n\nexport class FrameElement extends HTMLElement {\n  static delegateConstructor: new (element: FrameElement) => FrameElementDelegate\n\n  loaded: Promise<FetchResponse | void> = Promise.resolve()\n  readonly delegate: FrameElementDelegate\n\n  static get observedAttributes() {\n    return [\"disabled\", \"loading\", \"src\"]\n  }\n\n  constructor() {\n    super()\n    this.delegate = new FrameElement.delegateConstructor(this)\n  }\n\n  connectedCallback() {\n    this.delegate.connect()\n  }\n\n  disconnectedCallback() {\n    this.delegate.disconnect()\n  }\n\n  attributeChangedCallback(name: string) {\n    if (name == \"loading\") {\n      this.delegate.loadingStyleChanged()\n    } else if (name == \"src\") {\n      this.delegate.sourceURLChanged()\n    } else {\n      this.delegate.disabledChanged()\n    }\n  }\n\n  get src() {\n    return this.getAttribute(\"src\")\n  }\n\n  set src(value: string | null) {\n    if (value) {\n      this.setAttribute(\"src\", value)\n    } else {\n      this.removeAttribute(\"src\")\n    }\n  }\n\n  get loading(): FrameLoadingStyle {\n    return frameLoadingStyleFromString(this.getAttribute(\"loading\") || \"\")\n  }\n\n  set loading(value: FrameLoadingStyle) {\n    if (value) {\n      this.setAttribute(\"loading\", value)\n    } else {\n      this.removeAttribute(\"loading\")\n    }\n  }\n\n  get disabled() {\n    return this.hasAttribute(\"disabled\")\n  }\n\n  set disabled(value: boolean) {\n    if (value) {\n      this.setAttribute(\"disabled\", \"\")\n    } else {\n      this.removeAttribute(\"disabled\")\n    }\n  }\n\n  get autoscroll() {\n    return this.hasAttribute(\"autoscroll\")\n  }\n\n  set autoscroll(value: boolean) {\n    if (value) {\n      this.setAttribute(\"autoscroll\", \"\")\n    } else {\n      this.removeAttribute(\"autoscroll\")\n    }\n  }\n\n  get complete() {\n    return !this.delegate.isLoading\n  }\n\n  get isActive() {\n    return this.ownerDocument === document && !this.isPreview\n  }\n\n  get isPreview() {\n    return this.ownerDocument?.documentElement?.hasAttribute(\"data-turbo-preview\")\n  }\n}\n\nfunction frameLoadingStyleFromString(style: string) {\n  switch (style.toLowerCase()) {\n    case \"lazy\":  return FrameLoadingStyle.lazy\n    default:      return FrameLoadingStyle.eager\n  }\n}\n","import { FetchResponse } from \"./fetch_response\"\nimport { dispatch } from \"../util\"\n\nexport interface FetchRequestDelegate {\n  prepareHeadersForRequest?(headers: FetchRequestHeaders, request: FetchRequest): void\n  requestStarted(request: FetchRequest): void\n  requestPreventedHandlingResponse(request: FetchRequest, response: FetchResponse): void\n  requestSucceededWithResponse(request: FetchRequest, response: FetchResponse): void\n  requestFailedWithResponse(request: FetchRequest, response: FetchResponse): void\n  requestErrored(request: FetchRequest, error: Error): void\n  requestFinished(request: FetchRequest): void\n}\n\nexport enum FetchMethod {\n  get,\n  post,\n  put,\n  patch,\n  delete\n}\n\nexport function fetchMethodFromString(method: string) {\n  switch (method.toLowerCase()) {\n    case \"get\":    return FetchMethod.get\n    case \"post\":   return FetchMethod.post\n    case \"put\":    return FetchMethod.put\n    case \"patch\":  return FetchMethod.patch\n    case \"delete\": return FetchMethod.delete\n  }\n}\n\nexport type FetchRequestBody = FormData | URLSearchParams\n\nexport type FetchRequestHeaders = { [header: string]: string }\n\nexport interface FetchRequestOptions {\n  headers: FetchRequestHeaders\n  body: FetchRequestBody\n  followRedirects: boolean\n}\n\nexport class FetchRequest {\n  readonly delegate: FetchRequestDelegate\n  readonly method: FetchMethod\n  readonly headers: FetchRequestHeaders\n  readonly url: URL\n  readonly body?: FetchRequestBody\n  readonly abortController = new AbortController\n\n  constructor(delegate: FetchRequestDelegate, method: FetchMethod, location: URL, body: FetchRequestBody = new URLSearchParams) {\n    this.delegate = delegate\n    this.method = method\n    this.headers = this.defaultHeaders\n    if (this.isIdempotent) {\n      this.url = mergeFormDataEntries(location, [ ...body.entries() ])\n    } else {\n      this.body = body\n      this.url = location\n    }\n  }\n\n  get location(): URL {\n    return this.url\n  }\n\n  get params(): URLSearchParams {\n    return this.url.searchParams\n  }\n\n  get entries() {\n    return this.body ? Array.from(this.body.entries()) : []\n  }\n\n  cancel() {\n    this.abortController.abort()\n  }\n\n  async perform(): Promise<FetchResponse> {\n    const { fetchOptions } = this\n    this.delegate.prepareHeadersForRequest?.(this.headers, this)\n    dispatch(\"turbo:before-fetch-request\", { detail: { fetchOptions } })\n    try {\n      this.delegate.requestStarted(this)\n      const response = await fetch(this.url.href, fetchOptions)\n      return await this.receive(response)\n    } catch (error) {\n      this.delegate.requestErrored(this, error)\n      throw error\n    } finally {\n      this.delegate.requestFinished(this)\n    }\n  }\n\n  async receive(response: Response): Promise<FetchResponse> {\n    const fetchResponse = new FetchResponse(response)\n    const event = dispatch(\"turbo:before-fetch-response\", { cancelable: true, detail: { fetchResponse } })\n    if (event.defaultPrevented) {\n      this.delegate.requestPreventedHandlingResponse(this, fetchResponse)\n    } else if (fetchResponse.succeeded) {\n      this.delegate.requestSucceededWithResponse(this, fetchResponse)\n    } else {\n      this.delegate.requestFailedWithResponse(this, fetchResponse)\n    }\n    return fetchResponse\n  }\n\n  get fetchOptions(): RequestInit {\n    return {\n      method: FetchMethod[this.method].toUpperCase(),\n      credentials: \"same-origin\",\n      headers: this.headers,\n      redirect: \"follow\",\n      body: this.body,\n      signal: this.abortSignal\n    }\n  }\n\n  get defaultHeaders() {\n    return {\n      \"Accept\": \"text/html, application/xhtml+xml\"\n    }\n  }\n\n  get isIdempotent() {\n    return this.method == FetchMethod.get\n  }\n\n  get abortSignal() {\n    return this.abortController.signal\n  }\n}\n\nfunction mergeFormDataEntries(url: URL, entries: [string, FormDataEntryValue][]): URL {\n  const currentSearchParams = new URLSearchParams(url.search)\n\n  for (const [ name, value ] of entries) {\n    if (value instanceof File) continue\n\n    if (currentSearchParams.has(name)) {\n      currentSearchParams.delete(name)\n      url.searchParams.set(name, value)\n    } else {\n      url.searchParams.append(name, value)\n    }\n  }\n\n  return url\n}\n","import { FetchRequest, FetchMethod, fetchMethodFromString, FetchRequestHeaders } from \"../../http/fetch_request\"\nimport { FetchResponse } from \"../../http/fetch_response\"\nimport { expandURL } from \"../url\"\nimport { dispatch } from \"../../util\"\nimport { StreamMessage } from \"../streams/stream_message\"\n\nexport interface FormSubmissionDelegate {\n  formSubmissionStarted(formSubmission: FormSubmission): void\n  formSubmissionSucceededWithResponse(formSubmission: FormSubmission, fetchResponse: FetchResponse): void\n  formSubmissionFailedWithResponse(formSubmission: FormSubmission, fetchResponse: FetchResponse): void\n  formSubmissionErrored(formSubmission: FormSubmission, error: Error): void\n  formSubmissionFinished(formSubmission: FormSubmission): void\n}\n\nexport type FormSubmissionResult\n  = { success: boolean, fetchResponse: FetchResponse }\n  | { success: false, error: Error }\n\nexport enum FormSubmissionState {\n  initialized,\n  requesting,\n  waiting,\n  receiving,\n  stopping,\n  stopped,\n}\n\nenum FormEnctype {\n  urlEncoded = \"application/x-www-form-urlencoded\",\n  multipart  = \"multipart/form-data\",\n  plain      = \"text/plain\"\n}\n\nfunction formEnctypeFromString(encoding: string): FormEnctype {\n  switch(encoding.toLowerCase()) {\n    case FormEnctype.multipart: return FormEnctype.multipart\n    case FormEnctype.plain:     return FormEnctype.plain\n    default:                    return FormEnctype.urlEncoded\n  }\n}\n\nexport class FormSubmission {\n  readonly delegate: FormSubmissionDelegate\n  readonly formElement: HTMLFormElement\n  readonly submitter?: HTMLElement\n  readonly formData: FormData\n  readonly fetchRequest: FetchRequest\n  readonly mustRedirect: boolean\n  state = FormSubmissionState.initialized\n  result?: FormSubmissionResult\n\n  constructor(delegate: FormSubmissionDelegate, formElement: HTMLFormElement, submitter?: HTMLElement, mustRedirect = false) {\n    this.delegate = delegate\n    this.formElement = formElement\n    this.submitter = submitter\n    this.formData = buildFormData(formElement, submitter)\n    this.fetchRequest = new FetchRequest(this, this.method, this.location, this.body)\n    this.mustRedirect = mustRedirect\n  }\n\n  get method(): FetchMethod {\n    const method = this.submitter?.getAttribute(\"formmethod\") || this.formElement.getAttribute(\"method\") || \"\"\n    return fetchMethodFromString(method.toLowerCase()) || FetchMethod.get\n  }\n\n  get action(): string {\n    return this.submitter?.getAttribute(\"formaction\") || this.formElement.action\n  }\n\n  get location(): URL {\n    return expandURL(this.action)\n  }\n\n  get body() {\n    if (this.enctype == FormEnctype.urlEncoded || this.method == FetchMethod.get) {\n      return new URLSearchParams(this.stringFormData)\n    } else {\n      return this.formData\n    }\n  }\n\n  get enctype(): FormEnctype {\n    return formEnctypeFromString(this.submitter?.getAttribute(\"formenctype\") || this.formElement.enctype)\n  }\n\n  get isIdempotent() {\n    return this.fetchRequest.isIdempotent\n  }\n\n  get stringFormData() {\n    return [ ...this.formData ].reduce((entries, [ name, value ]) => {\n      return entries.concat(typeof value == \"string\" ? [[ name, value ]] : [])\n    }, [] as [string, string][])\n  }\n\n  // The submission process\n\n  async start() {\n    const { initialized, requesting } = FormSubmissionState\n    if (this.state == initialized) {\n      this.state = requesting\n      return this.fetchRequest.perform()\n    }\n  }\n\n  stop() {\n    const { stopping, stopped } = FormSubmissionState\n    if (this.state != stopping && this.state != stopped) {\n      this.state = stopping\n      this.fetchRequest.cancel()\n      return true\n    }\n  }\n\n  // Fetch request delegate\n\n  prepareHeadersForRequest(headers: FetchRequestHeaders, request: FetchRequest) {\n    if (!request.isIdempotent) {\n      const token = getCookieValue(getMetaContent(\"csrf-param\")) || getMetaContent(\"csrf-token\")\n      if (token) {\n        headers[\"X-CSRF-Token\"] = token\n      }\n      headers[\"Accept\"] = [ StreamMessage.contentType, headers[\"Accept\"] ].join(\", \")\n    }\n  }\n\n  requestStarted(request: FetchRequest) {\n    this.state = FormSubmissionState.waiting\n    dispatch(\"turbo:submit-start\", { target: this.formElement, detail: { formSubmission: this } })\n    this.delegate.formSubmissionStarted(this)\n  }\n\n  requestPreventedHandlingResponse(request: FetchRequest, response: FetchResponse) {\n    this.result = { success: response.succeeded, fetchResponse: response }\n  }\n\n  requestSucceededWithResponse(request: FetchRequest, response: FetchResponse) {\n    if (response.clientError || response.serverError) {\n      this.delegate.formSubmissionFailedWithResponse(this, response)\n    } else if (this.requestMustRedirect(request) && responseSucceededWithoutRedirect(response)) {\n      const error = new Error(\"Form responses must redirect to another location\")\n      this.delegate.formSubmissionErrored(this, error)\n    } else {\n      this.state = FormSubmissionState.receiving\n      this.result = { success: true, fetchResponse: response }\n      this.delegate.formSubmissionSucceededWithResponse(this, response)\n    }\n  }\n\n  requestFailedWithResponse(request: FetchRequest, response: FetchResponse) {\n    this.result = { success: false, fetchResponse: response }\n    this.delegate.formSubmissionFailedWithResponse(this, response)\n  }\n\n  requestErrored(request: FetchRequest, error: Error) {\n    this.result = { success: false, error }\n    this.delegate.formSubmissionErrored(this, error)\n  }\n\n  requestFinished(request: FetchRequest) {\n    this.state = FormSubmissionState.stopped\n    dispatch(\"turbo:submit-end\", { target: this.formElement, detail: { formSubmission: this, ...this.result }})\n    this.delegate.formSubmissionFinished(this)\n  }\n\n  requestMustRedirect(request: FetchRequest) {\n    return !request.isIdempotent && this.mustRedirect\n  }\n}\n\nfunction buildFormData(formElement: HTMLFormElement, submitter?: HTMLElement): FormData {\n  const formData = new FormData(formElement)\n  const name = submitter?.getAttribute(\"name\")\n  const value = submitter?.getAttribute(\"value\")\n\n  if (name && value != null && formData.get(name) != value) {\n    formData.append(name, value)\n  }\n\n  return formData\n}\n\nfunction getCookieValue(cookieName: string | null) {\n  if (cookieName != null) {\n    const cookies = document.cookie ? document.cookie.split(\"; \") : []\n    const cookie = cookies.find((cookie) => cookie.startsWith(cookieName))\n    if (cookie) {\n      const value = cookie.split(\"=\").slice(1).join(\"=\")\n      return value ? decodeURIComponent(value) : undefined\n    }\n  }\n}\n\nfunction getMetaContent(name: string) {\n  const element: HTMLMetaElement | null = document.querySelector(`meta[name=\"${name}\"]`)\n  return element && element.content\n}\n\nfunction responseSucceededWithoutRedirect(response: FetchResponse) {\n  return response.statusCode == 200 && !response.redirected\n}\n","import { Adapter } from \"../native/adapter\"\nimport { FetchMethod, FetchRequest, FetchRequestDelegate } from \"../../http/fetch_request\"\nimport { FetchResponse } from \"../../http/fetch_response\"\nimport { History } from \"./history\"\nimport { getAnchor } from \"../url\"\nimport { PageSnapshot } from \"./page_snapshot\"\nimport { Action } from \"../types\"\nimport { uuid } from \"../../util\"\nimport { PageView } from \"./page_view\"\n\nexport interface VisitDelegate {\n  readonly adapter: Adapter\n  readonly history: History\n  readonly view: PageView\n\n  visitStarted(visit: Visit): void\n  visitCompleted(visit: Visit): void\n}\n\nexport enum TimingMetric {\n  visitStart = \"visitStart\",\n  requestStart = \"requestStart\",\n  requestEnd = \"requestEnd\",\n  visitEnd = \"visitEnd\"\n}\n\nexport type TimingMetrics = Partial<{ [metric in TimingMetric]: any }>\n\nexport enum VisitState {\n  initialized = \"initialized\",\n  started = \"started\",\n  canceled = \"canceled\",\n  failed = \"failed\",\n  completed = \"completed\"\n}\n\nexport type VisitOptions = {\n  action: Action,\n  historyChanged: boolean,\n  referrer?: URL,\n  snapshotHTML?: string,\n  response?: VisitResponse\n}\n\nconst defaultOptions: VisitOptions = {\n  action: \"advance\",\n  historyChanged: false\n}\n\nexport type VisitResponse = {\n  statusCode: number,\n  responseHTML?: string\n}\n\nexport enum SystemStatusCode {\n  networkFailure = 0,\n  timeoutFailure = -1,\n  contentTypeMismatch = -2\n}\n\nexport class Visit implements FetchRequestDelegate {\n  readonly delegate: VisitDelegate\n  readonly identifier = uuid()\n  readonly restorationIdentifier: string\n  readonly action: Action\n  readonly referrer?: URL\n  readonly timingMetrics: TimingMetrics = {}\n\n  followedRedirect = false\n  frame?: number\n  historyChanged = false\n  location: URL\n  redirectedToLocation?: URL\n  request?: FetchRequest\n  response?: VisitResponse\n  scrolled = false\n  snapshotHTML?: string\n  snapshotCached = false\n  state = VisitState.initialized\n\n  constructor(delegate: VisitDelegate, location: URL, restorationIdentifier: string | undefined, options: Partial<VisitOptions> = {}) {\n    this.delegate = delegate\n    this.location = location\n    this.restorationIdentifier = restorationIdentifier || uuid()\n\n    const { action, historyChanged, referrer, snapshotHTML, response } = { ...defaultOptions, ...options }\n    this.action = action\n    this.historyChanged = historyChanged\n    this.referrer = referrer\n    this.snapshotHTML = snapshotHTML\n    this.response = response\n  }\n\n  get adapter() {\n    return this.delegate.adapter\n  }\n\n  get view() {\n    return this.delegate.view\n  }\n\n  get history() {\n    return this.delegate.history\n  }\n\n  get restorationData() {\n    return this.history.getRestorationDataForIdentifier(this.restorationIdentifier)\n  }\n\n  start() {\n    if (this.state == VisitState.initialized) {\n      this.recordTimingMetric(TimingMetric.visitStart)\n      this.state = VisitState.started\n      this.adapter.visitStarted(this)\n      this.delegate.visitStarted(this)\n    }\n  }\n\n  cancel() {\n    if (this.state == VisitState.started) {\n      if (this.request) {\n        this.request.cancel()\n      }\n      this.cancelRender()\n      this.state = VisitState.canceled\n    }\n  }\n\n  complete() {\n    if (this.state == VisitState.started) {\n      this.recordTimingMetric(TimingMetric.visitEnd)\n      this.state = VisitState.completed\n      this.adapter.visitCompleted(this)\n      this.delegate.visitCompleted(this)\n    }\n  }\n\n  fail() {\n    if (this.state == VisitState.started) {\n      this.state = VisitState.failed\n      this.adapter.visitFailed(this)\n    }\n  }\n\n  changeHistory() {\n    if (!this.historyChanged) {\n      const actionForHistory = this.location.href === this.referrer?.href ? \"replace\" : this.action\n      const method = this.getHistoryMethodForAction(actionForHistory)\n      this.history.update(method, this.location, this.restorationIdentifier)\n      this.historyChanged = true\n    }\n  }\n\n  issueRequest() {\n    if (this.hasPreloadedResponse()) {\n      this.simulateRequest()\n    } else if (this.shouldIssueRequest() && !this.request) {\n      this.request = new FetchRequest(this, FetchMethod.get, this.location)\n      this.request.perform()\n    }\n  }\n\n  simulateRequest() {\n    if (this.response) {\n      this.startRequest()\n      this.recordResponse()\n      this.finishRequest()\n    }\n  }\n\n  startRequest() {\n    this.recordTimingMetric(TimingMetric.requestStart)\n    this.adapter.visitRequestStarted(this)\n  }\n\n  recordResponse(response = this.response) {\n    this.response = response\n    if (response) {\n      const { statusCode } = response\n      if (isSuccessful(statusCode)) {\n        this.adapter.visitRequestCompleted(this)\n      } else {\n        this.adapter.visitRequestFailedWithStatusCode(this, statusCode)\n      }\n    }\n  }\n\n  finishRequest() {\n    this.recordTimingMetric(TimingMetric.requestEnd)\n    this.adapter.visitRequestFinished(this)\n  }\n\n  loadResponse() {\n    if (this.response) {\n      const { statusCode, responseHTML } = this.response\n      this.render(async () => {\n        this.cacheSnapshot()\n        if (isSuccessful(statusCode) && responseHTML != null) {\n          await this.view.renderPage(PageSnapshot.fromHTMLString(responseHTML))\n          this.adapter.visitRendered(this)\n          this.complete()\n        } else {\n          await this.view.renderError(PageSnapshot.fromHTMLString(responseHTML))\n          this.adapter.visitRendered(this)\n          this.fail()\n        }\n      })\n    }\n  }\n\n  getCachedSnapshot() {\n    const snapshot = this.view.getCachedSnapshotForLocation(this.location) || this.getPreloadedSnapshot()\n\n    if (snapshot && (!getAnchor(this.location) || snapshot.hasAnchor(getAnchor(this.location)))) {\n      if (this.action == \"restore\" || snapshot.isPreviewable) {\n        return snapshot\n      }\n    }\n  }\n\n  getPreloadedSnapshot() {\n    if (this.snapshotHTML) {\n      return PageSnapshot.fromHTMLString(this.snapshotHTML)\n    }\n  }\n\n  hasCachedSnapshot() {\n    return this.getCachedSnapshot() != null\n  }\n\n  loadCachedSnapshot() {\n    const snapshot = this.getCachedSnapshot()\n    if (snapshot) {\n      const isPreview = this.shouldIssueRequest()\n      this.render(async () => {\n        this.cacheSnapshot()\n        await this.view.renderPage(snapshot, isPreview)\n        this.adapter.visitRendered(this)\n        if (!isPreview) {\n          this.complete()\n        }\n      })\n    }\n  }\n\n  followRedirect() {\n    if (this.redirectedToLocation && !this.followedRedirect) {\n      this.location = this.redirectedToLocation\n      this.history.replace(this.redirectedToLocation, this.restorationIdentifier)\n      this.followedRedirect = true\n    }\n  }\n\n  // Fetch request delegate\n\n  requestStarted() {\n    this.startRequest()\n  }\n\n  requestPreventedHandlingResponse(request: FetchRequest, response: FetchResponse) {\n\n  }\n\n  async requestSucceededWithResponse(request: FetchRequest, response: FetchResponse) {\n    const responseHTML = await response.responseHTML\n    if (responseHTML == undefined) {\n      this.recordResponse({ statusCode: SystemStatusCode.contentTypeMismatch })\n    } else {\n      this.redirectedToLocation = response.redirected ? response.location : undefined\n      this.recordResponse({ statusCode: response.statusCode, responseHTML })\n    }\n  }\n\n  async requestFailedWithResponse(request: FetchRequest, response: FetchResponse) {\n    const responseHTML = await response.responseHTML\n    if (responseHTML == undefined) {\n      this.recordResponse({ statusCode: SystemStatusCode.contentTypeMismatch })\n    } else {\n      this.recordResponse({ statusCode: response.statusCode, responseHTML })\n    }\n  }\n\n  requestErrored(request: FetchRequest, error: Error) {\n    this.recordResponse({ statusCode: SystemStatusCode.networkFailure })\n  }\n\n  requestFinished() {\n    this.finishRequest()\n  }\n\n  // Scrolling\n\n  performScroll() {\n    if (!this.scrolled) {\n      if (this.action == \"restore\") {\n        this.scrollToRestoredPosition() || this.scrollToTop()\n      } else {\n        this.scrollToAnchor() || this.scrollToTop()\n      }\n      this.scrolled = true\n    }\n  }\n\n  scrollToRestoredPosition() {\n    const { scrollPosition } = this.restorationData\n    if (scrollPosition) {\n      this.view.scrollToPosition(scrollPosition)\n      return true\n    }\n  }\n\n  scrollToAnchor() {\n    if (getAnchor(this.location) != null) {\n      this.view.scrollToAnchor(getAnchor(this.location))\n      return true\n    }\n  }\n\n  scrollToTop() {\n    this.view.scrollToPosition({ x: 0, y: 0 })\n  }\n\n  // Instrumentation\n\n  recordTimingMetric(metric: TimingMetric) {\n    this.timingMetrics[metric] = new Date().getTime()\n  }\n\n  getTimingMetrics(): TimingMetrics {\n    return { ...this.timingMetrics }\n  }\n\n  // Private\n\n  getHistoryMethodForAction(action: Action) {\n    switch (action) {\n      case \"replace\": return history.replaceState\n      case \"advance\":\n      case \"restore\": return history.pushState\n    }\n  }\n\n  hasPreloadedResponse() {\n    return typeof this.response == \"object\"\n  }\n\n  shouldIssueRequest() {\n    return this.action == \"restore\"\n      ? !this.hasCachedSnapshot()\n      : true\n  }\n\n  cacheSnapshot() {\n    if (!this.snapshotCached) {\n      this.view.cacheSnapshot()\n      this.snapshotCached = true\n    }\n  }\n\n  async render(callback: () => Promise<void>) {\n    this.cancelRender()\n    await new Promise<void>(resolve => {\n      this.frame = requestAnimationFrame(() => resolve())\n    })\n    callback()\n    delete this.frame\n    this.performScroll()\n  }\n\n  cancelRender() {\n    if (this.frame) {\n      cancelAnimationFrame(this.frame)\n      delete this.frame\n    }\n  }\n}\n\nfunction isSuccessful(statusCode: number) {\n  return statusCode >= 200 && statusCode < 300\n}\n","export type Locatable = URL | string\n\nexport function expandURL(locatable: Locatable) {\n  return new URL(locatable.toString(), document.baseURI)\n}\n\nexport function getAnchor(url: URL) {\n  let anchorMatch\n  if (url.hash) {\n    return url.hash.slice(1)\n  } else if (anchorMatch = url.href.match(/#(.*)$/)) {\n    return anchorMatch[1]\n  } else {\n    return \"\"\n  }\n}\n\nexport function getExtension(url: URL) {\n  return (getLastPathComponent(url).match(/\\.[^.]*$/) || [])[0] || \"\"\n}\n\nexport function isHTML(url: URL) {\n  return !!getExtension(url).match(/^(?:|\\.(?:htm|html|xhtml))$/)\n}\n\nexport function isPrefixedBy(baseURL: URL, url: URL) {\n  const prefix = getPrefix(url)\n  return baseURL.href === expandURL(prefix).href || baseURL.href.startsWith(prefix)\n}\n\nexport function toCacheKey(url: URL) {\n  const anchorLength = url.hash.length\n  if (anchorLength < 2) {\n    return url.href\n  } else {\n    return url.href.slice(0, -anchorLength)\n  }\n}\n\nexport function urlsAreEqual(left: string, right: string) {\n  return expandURL(left).href == expandURL(right).href\n}\n\nfunction getPathComponents(url: URL) {\n  return url.pathname.split(\"/\").slice(1)\n}\n\nfunction getLastPathComponent(url: URL) {\n  return getPathComponents(url).slice(-1)[0]\n}\n\nfunction getPrefix(url: URL) {\n  return addTrailingSlash(url.origin + url.pathname)\n}\n\nfunction addTrailingSlash(value: string) {\n  return value.endsWith(\"/\") ? value : value + \"/\"\n}\n","import { expandURL } from \"../core/url\"\n\nexport class FetchResponse {\n  readonly response: Response\n\n  constructor(response: Response) {\n    this.response = response\n  }\n\n  get succeeded() {\n    return this.response.ok\n  }\n\n  get failed() {\n    return !this.succeeded\n  }\n\n  get clientError() {\n    return this.statusCode >= 400 && this.statusCode <= 499\n  }\n\n  get serverError() {\n    return this.statusCode >= 500 && this.statusCode <= 599\n  }\n\n  get redirected() {\n    return this.response.redirected\n  }\n\n  get location(): URL {\n    return expandURL(this.response.url)\n  }\n\n  get isHTML() {\n    return this.contentType && this.contentType.match(/^(?:text\\/([^\\s;,]+\\b)?html|application\\/xhtml\\+xml)\\b/)\n  }\n\n  get statusCode() {\n    return this.response.status\n  }\n\n  get contentType() {\n    return this.header(\"Content-Type\")\n  }\n\n  get responseText(): Promise<string> {\n    return this.response.text()\n  }\n\n  get responseHTML(): Promise<string | undefined> {\n    if (this.isHTML) {\n      return this.response.text()\n    } else {\n      return Promise.resolve(undefined)\n    }\n  }\n\n  header(name: string) {\n    return this.response.headers.get(name)\n  }\n}\n","export type DispatchOptions = { target: EventTarget, cancelable: boolean, detail: any }\n\nexport function dispatch(eventName: string, { target, cancelable, detail }: Partial<DispatchOptions> = {}) {\n  const event = new CustomEvent(eventName, { cancelable, bubbles: true, detail })\n  void (target || document.documentElement).dispatchEvent(event)\n  return event\n}\n\nexport function nextAnimationFrame() {\n  return new Promise<void>(resolve => requestAnimationFrame(() => resolve()))\n}\n\nexport function nextEventLoopTick() {\n  return new Promise<void>(resolve => setTimeout(() => resolve(), 0))\n}\n\nexport function nextMicrotask() {\n  return Promise.resolve()\n}\n\nexport function parseHTMLDocument(html = \"\") {\n  return new DOMParser().parseFromString(html, \"text/html\")\n}\n\nexport function unindent(strings: TemplateStringsArray, ...values: any[]): string {\n  const lines = interpolate(strings, values).replace(/^\\n/, \"\").split(\"\\n\")\n  const match = lines[0].match(/^\\s+/)\n  const indent = match ? match[0].length : 0\n  return lines.map(line => line.slice(indent)).join(\"\\n\")\n}\n\nfunction interpolate(strings: TemplateStringsArray, values: any[]) {\n  return strings.reduce((result, string, i) => {\n    const value = values[i] == undefined ? \"\" : values[i]\n    return result + string + value\n  }, \"\")\n}\n\nexport function uuid() {\n  return Array.apply(null, { length: 36 } as any).map((_, i) => {\n    if (i == 8 || i == 13 || i == 18 || i == 23) {\n      return \"-\"\n    } else if (i == 14) {\n      return \"4\"\n    } else if (i == 19) {\n      return (Math.floor(Math.random() * 4) + 8).toString(16)\n    } else {\n      return Math.floor(Math.random() * 15).toString(16)\n    }\n  }).join(\"\")\n}\n","export interface AppearanceObserverDelegate {\n  elementAppearedInViewport(element: Element): void\n}\n\nexport class AppearanceObserver {\n  readonly delegate: AppearanceObserverDelegate\n  readonly element: Element\n  readonly intersectionObserver: IntersectionObserver\n  started = false\n\n  constructor(delegate: AppearanceObserverDelegate, element: Element) {\n    this.delegate = delegate\n    this.element = element\n    this.intersectionObserver = new IntersectionObserver(this.intersect)\n  }\n\n  start() {\n    if (!this.started) {\n      this.started = true\n      this.intersectionObserver.observe(this.element)\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      this.started = false\n      this.intersectionObserver.unobserve(this.element)\n    }\n  }\n\n  intersect: IntersectionObserverCallback = entries => {\n    const lastEntry = entries.slice(-1)[0]\n    if (lastEntry?.isIntersecting) {\n      this.delegate.elementAppearedInViewport(this.element)\n    }\n  }\n}\n","import { StreamElement } from \"../../elements/stream_element\"\n\nexport class StreamMessage {\n  static readonly contentType = \"text/vnd.turbo-stream.html\"\n  readonly templateElement = document.createElement(\"template\")\n\n  static wrap(message: StreamMessage | string) {\n    if (typeof message == \"string\") {\n      return new this(message)\n    } else {\n      return message\n    }\n  }\n\n  constructor(html: string) {\n    this.templateElement.innerHTML = html\n  }\n\n  get fragment() {\n    const fragment = document.createDocumentFragment()\n    for (const element of this.foreignElements) {\n      fragment.appendChild(document.importNode(element, true))\n    }\n    return fragment\n  }\n\n  get foreignElements() {\n    return this.templateChildren.reduce((streamElements, child) => {\n      if (child.tagName.toLowerCase() == \"turbo-stream\") {\n        return [ ...streamElements, child as StreamElement ]\n      } else {\n        return streamElements\n      }\n    }, [] as StreamElement[])\n  }\n\n  get templateChildren() {\n    return Array.from(this.templateElement.content.children)\n  }\n}\n","export class Snapshot<E extends Element = Element> {\n  readonly element: E\n\n  constructor(element: E) {\n    this.element = element\n  }\n\n  get children() {\n    return [ ...this.element.children ]\n  }\n\n  hasAnchor(anchor: string) {\n    return this.getElementForAnchor(anchor) != null\n  }\n\n  getElementForAnchor(anchor: string) {\n    try {\n      return this.element.querySelector(`[id='${anchor}'], a[name='${anchor}']`)\n    } catch {\n      return null\n    }\n  }\n\n  get isConnected() {\n    return this.element.isConnected\n  }\n\n  get firstAutofocusableElement() {\n    return this.element.querySelector(\"[autofocus]\")\n  }\n\n  get permanentElements() {\n    return [ ...this.element.querySelectorAll(\"[id][data-turbo-permanent]\") ]\n  }\n\n  getPermanentElementById(id: string) {\n    return this.element.querySelector(`#${id}[data-turbo-permanent]`)\n  }\n\n  getPermanentElementMapForSnapshot(snapshot: Snapshot) {\n    const permanentElementMap: PermanentElementMap = {}\n\n    for (const currentPermanentElement of this.permanentElements) {\n      const { id } = currentPermanentElement\n      const newPermanentElement = snapshot.getPermanentElementById(id)\n      if (newPermanentElement) {\n        permanentElementMap[id] = [ currentPermanentElement, newPermanentElement ]\n      }\n    }\n\n    return permanentElementMap\n  }\n}\n\nexport type PermanentElementMap = Record<string, [Element, Element]>\n","export interface FormInterceptorDelegate {\n  shouldInterceptFormSubmission(element: HTMLFormElement, submitter?: HTMLElement): boolean\n  formSubmissionIntercepted(element: HTMLFormElement, submitter?: HTMLElement): void\n}\n\nexport class FormInterceptor {\n  readonly delegate: FormInterceptorDelegate\n  readonly element: Element\n\n  constructor(delegate: FormInterceptorDelegate, element: Element) {\n    this.delegate = delegate\n    this.element = element\n  }\n\n  start() {\n    this.element.addEventListener(\"submit\", this.submitBubbled)\n  }\n\n  stop() {\n    this.element.removeEventListener(\"submit\", this.submitBubbled)\n  }\n\n  submitBubbled = <EventListener>((event: SubmitEvent) => {\n    if (event.target instanceof HTMLFormElement) {\n      const form = event.target\n      const submitter = event.submitter || undefined\n      if (this.delegate.shouldInterceptFormSubmission(form, submitter)) {\n        event.preventDefault()\n        event.stopImmediatePropagation()\n        this.delegate.formSubmissionIntercepted(form, submitter)\n      }\n    }\n  })\n}\n","import { Renderer } from \"./renderer\"\nimport { Snapshot } from \"./snapshot\"\nimport { Position } from \"./types\"\n\nexport interface ViewDelegate<S extends Snapshot> {\n  viewWillRenderSnapshot(snapshot: S, isPreview: boolean): void\n  viewRenderedSnapshot(snapshot: S, isPreview: boolean): void\n  viewInvalidated(): void\n}\n\nexport abstract class View<E extends Element, S extends Snapshot<E> = Snapshot<E>, R extends Renderer<E, S> = Renderer<E, S>, D extends ViewDelegate<S> = ViewDelegate<S>> {\n  readonly delegate: D\n  readonly element: E\n  renderer?: R\n  abstract readonly snapshot: S\n\n  constructor(delegate: D, element: E) {\n    this.delegate = delegate\n    this.element = element\n  }\n\n  // Scrolling\n\n  scrollToAnchor(anchor: string) {\n    const element = this.snapshot.getElementForAnchor(anchor)\n    if (element) {\n      this.scrollToElement(element)\n    } else {\n      this.scrollToPosition({ x: 0, y: 0 })\n    }\n  }\n\n  scrollToElement(element: Element) {\n    element.scrollIntoView()\n  }\n\n  scrollToPosition({ x, y }: Position) {\n    this.scrollRoot.scrollTo(x, y)\n  }\n\n  get scrollRoot(): { scrollTo(x: number, y: number): void } {\n    return window\n  }\n\n  // Rendering\n\n  async render(renderer: R) {\n    if (this.renderer) {\n      throw new Error(\"rendering is already in progress\")\n    }\n\n    const { isPreview, shouldRender, newSnapshot: snapshot } = renderer\n    if (shouldRender) {\n      try {\n        this.renderer = renderer\n        this.prepareToRenderSnapshot(renderer)\n        this.delegate.viewWillRenderSnapshot(snapshot, isPreview)\n        await this.renderSnapshot(renderer)\n        this.delegate.viewRenderedSnapshot(snapshot, isPreview)\n        this.finishRenderingSnapshot(renderer)\n      } finally {\n        delete this.renderer\n      }\n    } else {\n      this.invalidate()\n    }\n  }\n\n  invalidate() {\n    this.delegate.viewInvalidated()\n  }\n\n  prepareToRenderSnapshot(renderer: R) {\n    this.markAsPreview(renderer.isPreview)\n    renderer.prepareToRender()\n  }\n\n  markAsPreview(isPreview: boolean) {\n    if (isPreview) {\n      this.element.setAttribute(\"data-turbo-preview\", \"\")\n    } else {\n      this.element.removeAttribute(\"data-turbo-preview\")\n    }\n  }\n\n  async renderSnapshot(renderer: R) {\n    await renderer.render()\n  }\n\n  finishRenderingSnapshot(renderer: R) {\n    renderer.finishRendering()\n  }\n}\n","import { FrameElement } from \"../../elements\"\nimport { Snapshot } from \"../snapshot\"\nimport { View } from \"../view\"\n\nexport class FrameView extends View<FrameElement> {\n  invalidate() {\n    this.element.innerHTML = \"\"\n  }\n\n  get snapshot() {\n    return new Snapshot(this.element)\n  }\n}\n","export interface LinkInterceptorDelegate {\n  shouldInterceptLinkClick(element: Element, url: string): boolean\n  linkClickIntercepted(element: Element, url: string): void\n}\n\nexport class LinkInterceptor {\n  readonly delegate: LinkInterceptorDelegate\n  readonly element: Element\n  private clickEvent?: Event\n\n  constructor(delegate: LinkInterceptorDelegate, element: Element) {\n    this.delegate = delegate\n    this.element = element\n  }\n\n  start() {\n    this.element.addEventListener(\"click\", this.clickBubbled)\n    document.addEventListener(\"turbo:click\", this.linkClicked)\n    document.addEventListener(\"turbo:before-visit\", this.willVisit)\n  }\n\n  stop() {\n    this.element.removeEventListener(\"click\", this.clickBubbled)\n    document.removeEventListener(\"turbo:click\", this.linkClicked)\n    document.removeEventListener(\"turbo:before-visit\", this.willVisit)\n  }\n\n  clickBubbled = (event: Event) => {\n    if (this.respondsToEventTarget(event.target)) {\n      this.clickEvent = event\n    } else {\n      delete this.clickEvent\n    }\n  }\n\n  linkClicked = <EventListener>((event: CustomEvent) => {\n    if (this.clickEvent && this.respondsToEventTarget(event.target) && event.target instanceof Element) {\n      if (this.delegate.shouldInterceptLinkClick(event.target, event.detail.url)) {\n        this.clickEvent.preventDefault()\n        event.preventDefault()\n        this.delegate.linkClickIntercepted(event.target, event.detail.url)\n      }\n    }\n    delete this.clickEvent\n  })\n\n  willVisit = () => {\n    delete this.clickEvent\n  }\n\n  respondsToEventTarget(target: EventTarget | null) {\n    const element\n      = target instanceof Element\n      ? target\n        : target instanceof Node\n        ? target.parentElement\n          : null\n    return element && element.closest(\"turbo-frame, html\") == this.element\n  }\n}\n","import { PermanentElementMap } from \"./snapshot\"\n\nexport class Bardo {\n  readonly permanentElementMap: PermanentElementMap\n\n  static preservingPermanentElements(permanentElementMap: PermanentElementMap, callback: () => void) {\n    const bardo = new this(permanentElementMap)\n    bardo.enter()\n    callback()\n    bardo.leave()\n  }\n\n  constructor(permanentElementMap: PermanentElementMap) {\n    this.permanentElementMap = permanentElementMap\n  }\n\n  enter() {\n    for (const id in this.permanentElementMap) {\n      const [, newPermanentElement ] = this.permanentElementMap[id]\n      this.replaceNewPermanentElementWithPlaceholder(newPermanentElement)\n    }\n  }\n\n  leave() {\n    for (const id in this.permanentElementMap) {\n      const [ currentPermanentElement ] = this.permanentElementMap[id]\n      this.replaceCurrentPermanentElementWithClone(currentPermanentElement)\n      this.replacePlaceholderWithPermanentElement(currentPermanentElement)\n    }\n  }\n\n  replaceNewPermanentElementWithPlaceholder(permanentElement: Element) {\n    const placeholder = createPlaceholderForPermanentElement(permanentElement)\n    permanentElement.replaceWith(placeholder)\n  }\n\n  replaceCurrentPermanentElementWithClone(permanentElement: Element) {\n    const clone = permanentElement.cloneNode(true)\n    permanentElement.replaceWith(clone)\n  }\n\n  replacePlaceholderWithPermanentElement(permanentElement: Element) {\n    const placeholder = this.getPlaceholderById(permanentElement.id)\n    placeholder?.replaceWith(permanentElement)\n  }\n\n  getPlaceholderById(id: string) {\n    return this.placeholders.find(element => element.content == id)\n  }\n\n  get placeholders(): HTMLMetaElement[] {\n    return [ ...document.querySelectorAll(\"meta[name=turbo-permanent-placeholder][content]\") ] as any\n  }\n}\n\nfunction createPlaceholderForPermanentElement(permanentElement: Element) {\n  const element = document.createElement(\"meta\")\n  element.setAttribute(\"name\", \"turbo-permanent-placeholder\")\n  element.setAttribute(\"content\", permanentElement.id)\n  return element\n}\n","import { Bardo } from \"./bardo\"\nimport { Snapshot } from \"./snapshot\"\n\ntype ResolvingFunctions<T = unknown> = {\n  resolve(value: T | PromiseLike<T>): void\n  reject(reason?: any): void\n}\n\nexport abstract class Renderer<E extends Element, S extends Snapshot<E> = Snapshot<E>> {\n  readonly currentSnapshot: S\n  readonly newSnapshot: S\n  readonly isPreview: boolean\n  readonly promise: Promise<void>\n  private resolvingFunctions?: ResolvingFunctions<void>\n\n  constructor(currentSnapshot: S, newSnapshot: S, isPreview: boolean) {\n    this.currentSnapshot = currentSnapshot\n    this.newSnapshot = newSnapshot\n    this.isPreview = isPreview\n    this.promise = new Promise((resolve, reject) => this.resolvingFunctions = { resolve, reject })\n  }\n\n  get shouldRender() {\n    return true\n  }\n\n  prepareToRender() {\n    return\n  }\n\n  abstract render(): Promise<void>\n\n  finishRendering() {\n    if (this.resolvingFunctions) {\n      this.resolvingFunctions.resolve()\n      delete this.resolvingFunctions\n    }\n  }\n\n  createScriptElement(element: Element) {\n    if (element.getAttribute(\"data-turbo-eval\") == \"false\") {\n      return element\n    } else {\n      const createdScriptElement = document.createElement(\"script\")\n      createdScriptElement.textContent = element.textContent\n      createdScriptElement.async = false\n      copyElementAttributes(createdScriptElement, element)\n      return createdScriptElement\n    }\n  }\n\n  preservingPermanentElements(callback: () => void) {\n    Bardo.preservingPermanentElements(this.permanentElementMap, callback)\n  }\n\n  focusFirstAutofocusableElement() {\n    const element = this.connectedSnapshot.firstAutofocusableElement\n    if (elementIsFocusable(element)) {\n      element.focus()\n    }\n  }\n\n  get connectedSnapshot() {\n    return this.newSnapshot.isConnected ? this.newSnapshot : this.currentSnapshot\n  }\n\n  get currentElement() {\n    return this.currentSnapshot.element\n  }\n\n  get newElement() {\n    return this.newSnapshot.element\n  }\n\n  get permanentElementMap() {\n    return this.currentSnapshot.getPermanentElementMapForSnapshot(this.newSnapshot)\n  }\n}\n\nfunction copyElementAttributes(destinationElement: Element, sourceElement: Element) {\n  for (const { name, value } of [ ...sourceElement.attributes ]) {\n    destinationElement.setAttribute(name, value)\n  }\n}\n\nfunction elementIsFocusable(element: any): element is { focus: () => void } {\n  return element && typeof element.focus == \"function\"\n}\n","import { FrameElement } from \"../../elements/frame_element\"\nimport { nextAnimationFrame } from \"../../util\"\nimport { Renderer } from \"../renderer\"\n\nexport class FrameRenderer extends Renderer<FrameElement> {\n  get shouldRender() {\n    return true\n  }\n\n  async render() {\n    await nextAnimationFrame()\n    this.preservingPermanentElements(() => {\n      this.loadFrameElement()\n    })\n    this.scrollFrameIntoView()\n    await nextAnimationFrame()\n    this.focusFirstAutofocusableElement()\n  }\n\n  loadFrameElement() {\n    const destinationRange = document.createRange()\n    destinationRange.selectNodeContents(this.currentElement)\n    destinationRange.deleteContents()\n\n    const frameElement = this.newElement\n    const sourceRange = frameElement.ownerDocument?.createRange()\n    if (sourceRange) {\n      sourceRange.selectNodeContents(frameElement)\n      this.currentElement.appendChild(sourceRange.extractContents())\n    }\n  }\n\n  scrollFrameIntoView() {\n    if (this.currentElement.autoscroll || this.newElement.autoscroll) {\n      const element = this.currentElement.firstElementChild\n      const block = readScrollLogicalPosition(this.currentElement.getAttribute(\"data-autoscroll-block\"), \"end\")\n\n      if (element) {\n        element.scrollIntoView({ block })\n        return true\n      }\n    }\n    return false\n  }\n}\n\nfunction readScrollLogicalPosition(value: string | null, defaultValue: ScrollLogicalPosition): ScrollLogicalPosition {\n  if (value == \"end\" || value == \"start\" || value == \"center\" || value == \"nearest\") {\n    return value\n  } else {\n    return defaultValue\n  }\n}\n","import { unindent } from \"../../util\"\n\nexport class ProgressBar {\n  static animationDuration = 300/*ms*/\n\n  static get defaultCSS() {\n    return unindent`\n      .turbo-progress-bar {\n        position: fixed;\n        display: block;\n        top: 0;\n        left: 0;\n        height: 3px;\n        background: #0076ff;\n        z-index: 9999;\n        transition:\n          width ${ProgressBar.animationDuration}ms ease-out,\n          opacity ${ProgressBar.animationDuration / 2}ms ${ProgressBar.animationDuration / 2}ms ease-in;\n        transform: translate3d(0, 0, 0);\n      }\n    `\n  }\n\n  readonly stylesheetElement: HTMLStyleElement\n  readonly progressElement: HTMLDivElement\n\n  hiding = false\n  trickleInterval?: number\n  value = 0\n  visible = false\n\n  constructor() {\n    this.stylesheetElement = this.createStylesheetElement()\n    this.progressElement = this.createProgressElement()\n    this.installStylesheetElement()\n    this.setValue(0)\n  }\n\n  show() {\n    if (!this.visible) {\n      this.visible = true\n      this.installProgressElement()\n      this.startTrickling()\n    }\n  }\n\n  hide() {\n    if (this.visible && !this.hiding) {\n      this.hiding = true\n      this.fadeProgressElement(() => {\n        this.uninstallProgressElement()\n        this.stopTrickling()\n        this.visible = false\n        this.hiding = false\n      })\n    }\n  }\n\n  setValue(value: number) {\n    this.value = value\n    this.refresh()\n  }\n\n  // Private\n\n  installStylesheetElement() {\n    document.head.insertBefore(this.stylesheetElement, document.head.firstChild)\n  }\n\n  installProgressElement() {\n    this.progressElement.style.width = \"0\"\n    this.progressElement.style.opacity = \"1\"\n    document.documentElement.insertBefore(this.progressElement, document.body)\n    this.refresh()\n  }\n\n  fadeProgressElement(callback: () => void) {\n    this.progressElement.style.opacity = \"0\"\n    setTimeout(callback, ProgressBar.animationDuration * 1.5)\n  }\n\n  uninstallProgressElement() {\n    if (this.progressElement.parentNode) {\n      document.documentElement.removeChild(this.progressElement)\n    }\n  }\n\n  startTrickling() {\n    if (!this.trickleInterval) {\n      this.trickleInterval = window.setInterval(this.trickle, ProgressBar.animationDuration)\n    }\n  }\n\n  stopTrickling() {\n    window.clearInterval(this.trickleInterval)\n    delete this.trickleInterval\n  }\n\n  trickle = () => {\n    this.setValue(this.value + Math.random() / 100)\n  }\n\n  refresh() {\n    requestAnimationFrame(() => {\n      this.progressElement.style.width = `${10 + (this.value * 90)}%`\n    })\n  }\n\n  createStylesheetElement() {\n    const element = document.createElement(\"style\")\n    element.type = \"text/css\"\n    element.textContent = ProgressBar.defaultCSS\n    return element\n  }\n\n  createProgressElement() {\n    const element = document.createElement(\"div\")\n    element.className = \"turbo-progress-bar\"\n    return element\n  }\n}\n","import { Snapshot } from \"../snapshot\"\n\ntype ElementDetailMap = { [outerHTML: string]: ElementDetails }\n\ntype ElementDetails = { type?: ElementType, tracked: boolean, elements: Element[] }\n\ntype ElementType = \"script\" | \"stylesheet\"\n\nexport class HeadSnapshot extends Snapshot<HTMLHeadElement> {\n  readonly detailsByOuterHTML = this.children.reduce((result, element) => {\n    const { outerHTML } = element\n    const details: ElementDetails\n      = outerHTML in result\n      ? result[outerHTML]\n      : {\n        type: elementType(element),\n        tracked: elementIsTracked(element),\n        elements: []\n      }\n    return {\n      ...result,\n      [outerHTML]: {\n        ...details,\n        elements: [ ...details.elements, element ]\n      }\n    }\n  }, {} as ElementDetailMap)\n\n  get trackedElementSignature(): string {\n    return Object.keys(this.detailsByOuterHTML)\n      .filter(outerHTML => this.detailsByOuterHTML[outerHTML].tracked)\n      .join(\"\")\n  }\n\n  getScriptElementsNotInSnapshot(snapshot: HeadSnapshot) {\n    return this.getElementsMatchingTypeNotInSnapshot(\"script\", snapshot)\n  }\n\n  getStylesheetElementsNotInSnapshot(snapshot: HeadSnapshot) {\n    return this.getElementsMatchingTypeNotInSnapshot(\"stylesheet\", snapshot)\n  }\n\n  getElementsMatchingTypeNotInSnapshot(matchedType: ElementType, snapshot: HeadSnapshot) {\n    return Object.keys(this.detailsByOuterHTML)\n      .filter(outerHTML => !(outerHTML in snapshot.detailsByOuterHTML))\n      .map(outerHTML => this.detailsByOuterHTML[outerHTML])\n      .filter(({ type }) => type == matchedType)\n      .map(({ elements: [element] }) => element)\n  }\n\n  get provisionalElements(): Element[] {\n    return Object.keys(this.detailsByOuterHTML).reduce((result, outerHTML) => {\n      const { type, tracked, elements } = this.detailsByOuterHTML[outerHTML]\n      if (type == null && !tracked) {\n        return [ ...result, ...elements ]\n      } else if (elements.length > 1) {\n        return [ ...result, ...elements.slice(1) ]\n      } else {\n        return result\n      }\n    }, [] as Element[])\n  }\n\n  getMetaValue(name: string): string | null {\n    const element = this.findMetaElementByName(name)\n    return element\n      ? element.getAttribute(\"content\")\n      : null\n  }\n\n  findMetaElementByName(name: string) {\n    return Object.keys(this.detailsByOuterHTML).reduce((result, outerHTML) => {\n      const { elements: [element] } = this.detailsByOuterHTML[outerHTML]\n      return elementIsMetaElementWithName(element, name) ? element : result\n    }, undefined as Element | undefined)\n  }\n}\n\nfunction elementType(element: Element) {\n  if (elementIsScript(element)) {\n    return \"script\"\n  } else if (elementIsStylesheet(element)) {\n    return \"stylesheet\"\n  }\n}\n\nfunction elementIsTracked(element: Element) {\n  return element.getAttribute(\"data-turbo-track\") == \"reload\"\n}\n\nfunction elementIsScript(element: Element) {\n  const tagName = element.tagName.toLowerCase()\n  return tagName == \"script\"\n}\n\nfunction elementIsStylesheet(element: Element) {\n  const tagName = element.tagName.toLowerCase()\n  return tagName == \"style\" || (tagName == \"link\" && element.getAttribute(\"rel\") == \"stylesheet\")\n}\n\nfunction elementIsMetaElementWithName(element: Element, name: string) {\n  const tagName = element.tagName.toLowerCase()\n  return tagName == \"meta\" && element.getAttribute(\"name\") == name\n}\n","import { parseHTMLDocument } from \"../../util\"\nimport { Snapshot } from \"../snapshot\"\nimport { expandURL } from \"../url\"\nimport { HeadSnapshot } from \"./head_snapshot\"\n\nexport class PageSnapshot extends Snapshot<HTMLBodyElement> {\n  static fromHTMLString(html = \"\") {\n    return this.fromDocument(parseHTMLDocument(html))\n  }\n\n  static fromElement(element: Element) {\n    return this.fromDocument(element.ownerDocument)\n  }\n\n  static fromDocument({ head, body }: Document) {\n    return new this(body as HTMLBodyElement, new HeadSnapshot(head))\n  }\n\n  readonly headSnapshot: HeadSnapshot\n\n  constructor(element: HTMLBodyElement, headSnapshot: HeadSnapshot) {\n    super(element)\n    this.headSnapshot = headSnapshot\n  }\n\n  clone() {\n    return new PageSnapshot(this.element.cloneNode(true), this.headSnapshot)\n  }\n\n  get headElement() {\n    return this.headSnapshot.element\n  }\n\n  get rootLocation() {\n    const root = this.getSetting(\"root\") ?? \"/\"\n    return expandURL(root)\n  }\n\n  get cacheControlValue() {\n    return this.getSetting(\"cache-control\")\n  }\n\n  get isPreviewable() {\n    return this.cacheControlValue != \"no-preview\"\n  }\n\n  get isCacheable() {\n    return this.cacheControlValue != \"no-cache\"\n  }\n\n  get isVisitable() {\n    return this.getSetting(\"visit-control\") != \"reload\"\n  }\n\n  // Private\n\n  getSetting(name: string) {\n    return this.headSnapshot.getMetaValue(`turbo-${name}`)\n  }\n}\n","export interface PageObserverDelegate {\n  pageBecameInteractive(): void\n  pageLoaded(): void\n  pageWillUnload(): void\n}\n\nexport enum PageStage {\n  initial,\n  loading,\n  interactive,\n  complete\n}\n\nexport class PageObserver {\n  readonly delegate: PageObserverDelegate\n  stage = PageStage.initial\n  started = false\n\n  constructor(delegate: PageObserverDelegate) {\n    this.delegate = delegate\n  }\n\n  start() {\n    if (!this.started) {\n      if (this.stage == PageStage.initial) {\n        this.stage = PageStage.loading\n      }\n      document.addEventListener(\"readystatechange\", this.interpretReadyState, false)\n      addEventListener(\"pagehide\", this.pageWillUnload, false)\n      this.started = true\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      document.removeEventListener(\"readystatechange\", this.interpretReadyState, false)\n      removeEventListener(\"pagehide\", this.pageWillUnload, false)\n      this.started = false\n    }\n  }\n\n  interpretReadyState = () => {\n    const { readyState } = this\n    if (readyState == \"interactive\") {\n      this.pageIsInteractive()\n    } else if (readyState == \"complete\") {\n      this.pageIsComplete()\n    }\n  }\n\n  pageIsInteractive() {\n    if (this.stage == PageStage.loading) {\n      this.stage = PageStage.interactive\n      this.delegate.pageBecameInteractive()\n    }\n  }\n\n  pageIsComplete() {\n    this.pageIsInteractive()\n    if (this.stage == PageStage.interactive) {\n      this.stage = PageStage.complete\n      this.delegate.pageLoaded()\n    }\n  }\n\n  pageWillUnload = () => {\n    this.delegate.pageWillUnload()\n  }\n\n  get readyState() {\n    return document.readyState\n  }\n}\n","import { Adapter } from \"./adapter\"\nimport { ProgressBar } from \"../drive/progress_bar\"\nimport { SystemStatusCode, Visit, VisitOptions } from \"../drive/visit\"\nimport { Session } from \"../session\"\nimport { uuid } from \"../../util\"\n\nexport class BrowserAdapter implements Adapter {\n  readonly session: Session\n  readonly progressBar = new ProgressBar\n\n  progressBarTimeout?: number\n\n  constructor(session: Session) {\n    this.session = session\n  }\n\n  visitProposedToLocation(location: URL, options?: Partial<VisitOptions>) {\n    this.navigator.startVisit(location, uuid(), options)\n  }\n\n  visitStarted(visit: Visit) {\n    visit.issueRequest()\n    visit.changeHistory()\n    visit.loadCachedSnapshot()\n  }\n\n  visitRequestStarted(visit: Visit) {\n    this.progressBar.setValue(0)\n    if (visit.hasCachedSnapshot() || visit.action != \"restore\") {\n      this.showProgressBarAfterDelay()\n    } else {\n      this.showProgressBar()\n    }\n  }\n\n  visitRequestCompleted(visit: Visit) {\n    visit.loadResponse()\n  }\n\n  visitRequestFailedWithStatusCode(visit: Visit, statusCode: number) {\n    switch (statusCode) {\n      case SystemStatusCode.networkFailure:\n      case SystemStatusCode.timeoutFailure:\n      case SystemStatusCode.contentTypeMismatch:\n        return this.reload()\n      default:\n        return visit.loadResponse()\n    }\n  }\n\n  visitRequestFinished(visit: Visit) {\n    this.progressBar.setValue(1)\n    this.hideProgressBar()\n  }\n\n  visitCompleted(visit: Visit) {\n    visit.followRedirect()\n  }\n\n  pageInvalidated() {\n    this.reload()\n  }\n\n  visitFailed(visit: Visit) {\n\n  }\n\n  visitRendered(visit: Visit) {\n\n  }\n\n  // Private\n\n  showProgressBarAfterDelay() {\n    this.progressBarTimeout = window.setTimeout(this.showProgressBar, this.session.progressBarDelay)\n  }\n\n  showProgressBar = () => {\n    this.progressBar.show()\n  }\n\n  hideProgressBar() {\n    this.progressBar.hide()\n    if (this.progressBarTimeout != null) {\n      window.clearTimeout(this.progressBarTimeout)\n      delete this.progressBarTimeout\n    }\n  }\n\n  reload() {\n    window.location.reload()\n  }\n\n  get navigator() {\n    return this.session.navigator\n  }\n}\n","export interface FormSubmitObserverDelegate {\n  willSubmitForm(form: HTMLFormElement, submitter?: HTMLElement): boolean\n  formSubmitted(form: HTMLFormElement, submitter?: HTMLElement): void\n}\n\nexport class FormSubmitObserver {\n  readonly delegate: FormSubmitObserverDelegate\n  started = false\n\n  constructor(delegate: FormSubmitObserverDelegate) {\n    this.delegate = delegate\n  }\n\n  start() {\n    if (!this.started) {\n      addEventListener(\"submit\", this.submitCaptured, true)\n      this.started = true\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      removeEventListener(\"submit\", this.submitCaptured, true)\n      this.started = false\n    }\n  }\n\n  submitCaptured = () => {\n    removeEventListener(\"submit\", this.submitBubbled, false)\n    addEventListener(\"submit\", this.submitBubbled, false)\n  }\n\n  submitBubbled = <EventListener>((event: SubmitEvent) => {\n    if (!event.defaultPrevented) {\n      const form = event.target instanceof HTMLFormElement ? event.target : undefined\n      const submitter = event.submitter || undefined\n\n      if (form) {\n        const method = submitter?.getAttribute(\"formmethod\") || form.method\n\n        if (method != \"dialog\" && this.delegate.willSubmitForm(form, submitter)) {\n          event.preventDefault()\n          this.delegate.formSubmitted(form, submitter)\n        }\n      }\n    }\n  })\n}\n","import { FormInterceptor, FormInterceptorDelegate } from \"./form_interceptor\"\nimport { FrameElement } from \"../../elements/frame_element\"\nimport { LinkInterceptor, LinkInterceptorDelegate } from \"./link_interceptor\"\n\nexport class FrameRedirector implements LinkInterceptorDelegate, FormInterceptorDelegate {\n  readonly element: Element\n  readonly linkInterceptor: LinkInterceptor\n  readonly formInterceptor: FormInterceptor\n\n  constructor(element: Element) {\n    this.element = element\n    this.linkInterceptor = new LinkInterceptor(this, element)\n    this.formInterceptor = new FormInterceptor(this, element)\n  }\n\n  start() {\n    this.linkInterceptor.start()\n    this.formInterceptor.start()\n  }\n\n  stop() {\n    this.linkInterceptor.stop()\n    this.formInterceptor.stop()\n  }\n\n  shouldInterceptLinkClick(element: Element, url: string) {\n    return this.shouldRedirect(element)\n  }\n\n  linkClickIntercepted(element: Element, url: string) {\n    const frame = this.findFrameElement(element)\n    if (frame) {\n      frame.src = url\n    }\n  }\n\n  shouldInterceptFormSubmission(element: HTMLFormElement, submitter?: HTMLElement) {\n    return this.shouldRedirect(element, submitter)\n  }\n\n  formSubmissionIntercepted(element: HTMLFormElement, submitter?: HTMLElement) {\n    const frame = this.findFrameElement(element)\n    if (frame) {\n      frame.delegate.formSubmissionIntercepted(element, submitter)\n    }\n  }\n\n  private shouldRedirect(element: Element, submitter?: HTMLElement) {\n    const frame = this.findFrameElement(element)\n    return frame ? frame != element.closest(\"turbo-frame\") : false\n  }\n\n  private findFrameElement(element: Element) {\n    const id = element.getAttribute(\"data-turbo-frame\")\n    if (id && id != \"_top\") {\n      const frame = this.element.querySelector(`#${id}:not([disabled])`)\n      if (frame instanceof FrameElement) {\n        return frame\n      }\n    }\n  }\n}\n","import { Position } from \"../types\"\nimport { nextMicrotask, uuid } from \"../../util\"\n\nexport interface HistoryDelegate {\n  historyPoppedToLocationWithRestorationIdentifier(location: URL, restorationIdentifier: string): void\n}\n\ntype HistoryMethod = (this: typeof history, state: any, title: string, url?: string | null | undefined) => void\n\nexport type RestorationData = { scrollPosition?: Position }\n\nexport type RestorationDataMap = { [restorationIdentifier: string]: RestorationData }\n\nexport class History {\n  readonly delegate: HistoryDelegate\n  location!: URL\n  restorationIdentifier = uuid()\n  restorationData: RestorationDataMap = {}\n  started = false\n  pageLoaded = false\n  previousScrollRestoration?: ScrollRestoration\n\n  constructor(delegate: HistoryDelegate) {\n    this.delegate = delegate\n  }\n\n  start() {\n    if (!this.started) {\n      addEventListener(\"popstate\", this.onPopState, false)\n      addEventListener(\"load\", this.onPageLoad, false)\n      this.started = true\n      this.replace(new URL(window.location.href))\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      removeEventListener(\"popstate\", this.onPopState, false)\n      removeEventListener(\"load\", this.onPageLoad, false)\n      this.started = false\n    }\n  }\n\n  push(location: URL, restorationIdentifier?: string) {\n    this.update(history.pushState, location, restorationIdentifier)\n  }\n\n  replace(location: URL, restorationIdentifier?: string) {\n    this.update(history.replaceState, location, restorationIdentifier)\n  }\n\n  update(method: HistoryMethod, location: URL, restorationIdentifier = uuid()) {\n    const state = { turbo: { restorationIdentifier } }\n    method.call(history, state, \"\", location.href)\n    this.location = location\n    this.restorationIdentifier = restorationIdentifier\n  }\n\n  // Restoration data\n\n  getRestorationDataForIdentifier(restorationIdentifier: string): RestorationData {\n    return this.restorationData[restorationIdentifier] || {}\n  }\n\n  updateRestorationData(additionalData: Partial<RestorationData>) {\n    const { restorationIdentifier } = this\n    const restorationData = this.restorationData[restorationIdentifier]\n    this.restorationData[restorationIdentifier] = { ...restorationData, ...additionalData }\n  }\n\n  // Scroll restoration\n\n  assumeControlOfScrollRestoration() {\n    if (!this.previousScrollRestoration) {\n      this.previousScrollRestoration = history.scrollRestoration ?? \"auto\"\n      history.scrollRestoration = \"manual\"\n    }\n  }\n\n  relinquishControlOfScrollRestoration() {\n    if (this.previousScrollRestoration) {\n      history.scrollRestoration = this.previousScrollRestoration\n      delete this.previousScrollRestoration\n    }\n  }\n\n  // Event handlers\n\n  onPopState = (event: PopStateEvent) => {\n    if (this.shouldHandlePopState()) {\n      const { turbo } = event.state || {}\n      if (turbo) {\n        this.location = new URL(window.location.href)\n        const { restorationIdentifier } = turbo\n        this.restorationIdentifier = restorationIdentifier\n        this.delegate.historyPoppedToLocationWithRestorationIdentifier(this.location, restorationIdentifier)\n      }\n    }\n  }\n\n  onPageLoad = async (event: Event) => {\n    await nextMicrotask()\n    this.pageLoaded = true\n  }\n\n  // Private\n\n  shouldHandlePopState() {\n    // Safari dispatches a popstate event after window's load event, ignore it\n    return this.pageIsLoaded()\n  }\n\n  pageIsLoaded() {\n    return this.pageLoaded || document.readyState == \"complete\"\n  }\n}\n","import { expandURL } from \"../core/url\"\n\nexport interface LinkClickObserverDelegate {\n  willFollowLinkToLocation(link: Element, location: URL): boolean\n  followedLinkToLocation(link: Element, location: URL): void\n}\n\nexport class LinkClickObserver {\n  readonly delegate: LinkClickObserverDelegate\n  started = false\n\n  constructor(delegate: LinkClickObserverDelegate) {\n    this.delegate = delegate\n  }\n\n  start() {\n    if (!this.started) {\n      addEventListener(\"click\", this.clickCaptured, true)\n      this.started = true\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      removeEventListener(\"click\", this.clickCaptured, true)\n      this.started = false\n    }\n  }\n\n  clickCaptured = () => {\n    removeEventListener(\"click\", this.clickBubbled, false)\n    addEventListener(\"click\", this.clickBubbled, false)\n  }\n\n  clickBubbled = (event: MouseEvent) => {\n    if (this.clickEventIsSignificant(event)) {\n      const link = this.findLinkFromClickTarget(event.target)\n      if (link) {\n        const location = this.getLocationForLink(link)\n        if (this.delegate.willFollowLinkToLocation(link, location)) {\n          event.preventDefault()\n          this.delegate.followedLinkToLocation(link, location)\n        }\n      }\n    }\n  }\n\n  clickEventIsSignificant(event: MouseEvent) {\n    return !(\n      (event.target && (event.target as any).isContentEditable)\n      || event.defaultPrevented\n      || event.which > 1\n      || event.altKey\n      || event.ctrlKey\n      || event.metaKey\n      || event.shiftKey\n    )\n  }\n\n  findLinkFromClickTarget(target: EventTarget | null) {\n    if (target instanceof Element) {\n      return target.closest(\"a[href]:not([target^=_]):not([download])\")\n    }\n  }\n\n  getLocationForLink(link: Element): URL {\n    return expandURL(link.getAttribute(\"href\") || \"\")\n  }\n}\n","export type Action = \"advance\" | \"replace\" | \"restore\"\n\nexport function isAction(action: any): action is Action {\n  return action == \"advance\" || action == \"replace\" || action == \"restore\"\n}\n\nexport type Position = { x: number, y: number }\n\nexport type StreamSource = {\n  addEventListener(type: \"message\", listener: (event: MessageEvent) => void, options?: boolean | AddEventListenerOptions): void\n  removeEventListener(type: \"message\", listener: (event: MessageEvent) => void, options?: boolean | EventListenerOptions): void\n}\n","import { Action, isAction } from \"../types\"\nimport { FetchMethod } from \"../../http/fetch_request\"\nimport { FetchResponse } from \"../../http/fetch_response\"\nimport { FormSubmission } from \"./form_submission\"\nimport { expandURL, Locatable } from \"../url\"\nimport { Visit, VisitDelegate, VisitOptions } from \"./visit\"\nimport { PageSnapshot } from \"./page_snapshot\"\n\nexport type NavigatorDelegate = VisitDelegate & {\n  allowsVisitingLocation(location: URL): boolean\n  visitProposedToLocation(location: URL, options: Partial<VisitOptions>): void\n}\n\nexport class Navigator {\n  readonly delegate: NavigatorDelegate\n  formSubmission?: FormSubmission\n  currentVisit?: Visit\n\n  constructor(delegate: NavigatorDelegate) {\n    this.delegate = delegate\n  }\n\n  proposeVisit(location: URL, options: Partial<VisitOptions> = {}) {\n    if (this.delegate.allowsVisitingLocation(location)) {\n      this.delegate.visitProposedToLocation(location, options)\n    }\n  }\n\n  startVisit(locatable: Locatable, restorationIdentifier: string, options: Partial<VisitOptions> = {}) {\n    this.stop()\n    this.currentVisit = new Visit(this, expandURL(locatable), restorationIdentifier, {\n      referrer: this.location,\n      ...options\n    })\n    this.currentVisit.start()\n  }\n\n  submitForm(form: HTMLFormElement, submitter?: HTMLElement) {\n    this.stop()\n    this.formSubmission = new FormSubmission(this, form, submitter, true)\n\n    if (this.formSubmission.isIdempotent) {\n      this.proposeVisit(this.formSubmission.fetchRequest.url, { action: this.getActionForFormSubmission(this.formSubmission) })\n    } else {\n      this.formSubmission.start()\n    }\n  }\n\n  stop() {\n    if (this.formSubmission) {\n      this.formSubmission.stop()\n      delete this.formSubmission\n    }\n\n    if (this.currentVisit) {\n      this.currentVisit.cancel()\n      delete this.currentVisit\n    }\n  }\n\n  get adapter() {\n    return this.delegate.adapter\n  }\n\n  get view() {\n    return this.delegate.view\n  }\n\n  get history() {\n    return this.delegate.history\n  }\n\n  // Form submission delegate\n\n  formSubmissionStarted(formSubmission: FormSubmission) {\n\n  }\n\n  async formSubmissionSucceededWithResponse(formSubmission: FormSubmission, fetchResponse: FetchResponse) {\n    if (formSubmission == this.formSubmission) {\n      const responseHTML = await fetchResponse.responseHTML\n      if (responseHTML) {\n        if (formSubmission.method != FetchMethod.get) {\n          this.view.clearSnapshotCache()\n        }\n\n        const { statusCode } = fetchResponse\n        const visitOptions = { response: { statusCode, responseHTML } }\n        this.proposeVisit(fetchResponse.location, visitOptions)\n      }\n    }\n  }\n\n  async formSubmissionFailedWithResponse(formSubmission: FormSubmission, fetchResponse: FetchResponse) {\n    const responseHTML = await fetchResponse.responseHTML\n\n    if (responseHTML) {\n      const snapshot = PageSnapshot.fromHTMLString(responseHTML)\n      await this.view.renderPage(snapshot)\n      this.view.clearSnapshotCache()\n    }\n  }\n\n  formSubmissionErrored(formSubmission: FormSubmission, error: Error) {\n    console.error(error)\n  }\n\n  formSubmissionFinished(formSubmission: FormSubmission) {\n\n  }\n\n  // Visit delegate\n\n  visitStarted(visit: Visit) {\n    this.delegate.visitStarted(visit)\n  }\n\n  visitCompleted(visit: Visit) {\n    this.delegate.visitCompleted(visit)\n  }\n\n  // Visits\n\n  get location() {\n    return this.history.location\n  }\n\n  get restorationIdentifier() {\n    return this.history.restorationIdentifier\n  }\n\n  getActionForFormSubmission(formSubmission: FormSubmission): Action {\n    const { formElement, submitter } = formSubmission\n    const action = submitter?.getAttribute(\"data-turbo-action\") || formElement.getAttribute(\"data-turbo-action\")\n    return isAction(action) ? action : \"advance\"\n  }\n}\n","import { Position } from \"../core/types\"\n\nexport interface ScrollObserverDelegate {\n  scrollPositionChanged(position: Position): void\n}\n\nexport class ScrollObserver {\n  readonly delegate: ScrollObserverDelegate\n  started = false\n\n  constructor(delegate: ScrollObserverDelegate) {\n    this.delegate = delegate\n  }\n\n  start() {\n    if (!this.started) {\n      addEventListener(\"scroll\", this.onScroll, false)\n      this.onScroll()\n      this.started = true\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      removeEventListener(\"scroll\", this.onScroll, false)\n      this.started = false\n    }\n  }\n\n  onScroll = () => {\n    this.updatePosition({ x: window.pageXOffset, y: window.pageYOffset })\n  }\n\n  // Private\n\n  updatePosition(position: Position) {\n    this.delegate.scrollPositionChanged(position)\n  }\n}\n","import { FetchResponse } from \"../http/fetch_response\"\nimport { StreamMessage } from \"../core/streams/stream_message\"\nimport { StreamSource } from \"../core/types\"\n\nexport interface StreamObserverDelegate {\n  receivedMessageFromStream(message: StreamMessage): void\n}\n\nexport class StreamObserver {\n  readonly delegate: StreamObserverDelegate\n  readonly sources: Set<StreamSource> = new Set\n  private started = false\n\n  constructor(delegate: StreamObserverDelegate) {\n    this.delegate = delegate\n  }\n\n  start() {\n    if (!this.started) {\n      this.started = true\n      addEventListener(\"turbo:before-fetch-response\", this.inspectFetchResponse, false)\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      this.started = false\n      removeEventListener(\"turbo:before-fetch-response\", this.inspectFetchResponse, false)\n    }\n  }\n\n  connectStreamSource(source: StreamSource) {\n    if (!this.streamSourceIsConnected(source)) {\n      this.sources.add(source)\n      source.addEventListener(\"message\", this.receiveMessageEvent, false)\n    }\n  }\n\n  disconnectStreamSource(source: StreamSource) {\n    if (this.streamSourceIsConnected(source)) {\n      this.sources.delete(source)\n      source.removeEventListener(\"message\", this.receiveMessageEvent, false)\n    }\n  }\n\n  streamSourceIsConnected(source: StreamSource) {\n    return this.sources.has(source)\n  }\n\n  inspectFetchResponse = <EventListener>((event: CustomEvent) => {\n    const response = fetchResponseFromEvent(event)\n    if (response && fetchResponseIsStream(response)) {\n      event.preventDefault()\n      this.receiveMessageResponse(response)\n    }\n  })\n\n  receiveMessageEvent = (event: MessageEvent) => {\n    if (this.started && typeof event.data == \"string\") {\n      this.receiveMessageHTML(event.data)\n    }\n  }\n\n  async receiveMessageResponse(response: FetchResponse) {\n    const html = await response.responseHTML\n    if (html) {\n      this.receiveMessageHTML(html)\n    }\n  }\n\n  receiveMessageHTML(html: string) {\n    this.delegate.receivedMessageFromStream(new StreamMessage(html))\n  }\n}\n\nfunction fetchResponseFromEvent(event: CustomEvent) {\n  const fetchResponse = event.detail?.fetchResponse\n  if (fetchResponse instanceof FetchResponse) {\n    return fetchResponse\n  }\n}\n\nfunction fetchResponseIsStream(response: FetchResponse) {\n  const contentType = response.contentType ?? \"\"\n  return contentType.startsWith(StreamMessage.contentType)\n}\n","import { PageSnapshot } from \"./page_snapshot\"\nimport { Renderer } from \"../renderer\"\n\nexport class ErrorRenderer extends Renderer<HTMLBodyElement, PageSnapshot> {\n  async render() {\n    this.replaceHeadAndBody()\n    this.activateScriptElements()\n  }\n\n  replaceHeadAndBody() {\n    const { documentElement, head, body } = document\n    documentElement.replaceChild(this.newHead, head)\n    documentElement.replaceChild(this.newElement, body)\n  }\n\n  activateScriptElements() {\n    for (const replaceableElement of this.scriptElements) {\n      const parentNode = replaceableElement.parentNode\n      if (parentNode) {\n        const element = this.createScriptElement(replaceableElement)\n        parentNode.replaceChild(element, replaceableElement)\n      }\n    }\n  }\n\n  get newHead() {\n    return this.newSnapshot.headSnapshot.element\n  }\n\n  get scriptElements() {\n    return [ ...document.documentElement.querySelectorAll(\"script\") ]\n  }\n}\n","import { Renderer } from \"../renderer\"\nimport { PageSnapshot } from \"./page_snapshot\"\n\nexport class PageRenderer extends Renderer<HTMLBodyElement, PageSnapshot> {\n  get shouldRender() {\n    return this.newSnapshot.isVisitable && this.trackedElementsAreIdentical\n  }\n\n  prepareToRender() {\n    this.mergeHead()\n  }\n\n  async render() {\n    this.replaceBody()\n  }\n\n  finishRendering() {\n    super.finishRendering()\n    if (!this.isPreview) {\n      this.focusFirstAutofocusableElement()\n    }\n  }\n\n  get currentHeadSnapshot() {\n    return this.currentSnapshot.headSnapshot\n  }\n\n  get newHeadSnapshot() {\n    return this.newSnapshot.headSnapshot\n  }\n\n  get newElement() {\n    return this.newSnapshot.element\n  }\n\n  mergeHead() {\n    this.copyNewHeadStylesheetElements()\n    this.copyNewHeadScriptElements()\n    this.removeCurrentHeadProvisionalElements()\n    this.copyNewHeadProvisionalElements()\n  }\n\n  replaceBody() {\n    this.preservingPermanentElements(() => {\n      this.activateNewBody()\n      this.assignNewBody()\n    })\n  }\n\n  get trackedElementsAreIdentical() {\n    return this.currentHeadSnapshot.trackedElementSignature == this.newHeadSnapshot.trackedElementSignature\n  }\n\n  copyNewHeadStylesheetElements() {\n    for (const element of this.newHeadStylesheetElements) {\n      document.head.appendChild(element)\n    }\n  }\n\n  copyNewHeadScriptElements() {\n    for (const element of this.newHeadScriptElements) {\n      document.head.appendChild(this.createScriptElement(element))\n    }\n  }\n\n  removeCurrentHeadProvisionalElements() {\n    for (const element of this.currentHeadProvisionalElements) {\n      document.head.removeChild(element)\n    }\n  }\n\n  copyNewHeadProvisionalElements() {\n    for (const element of this.newHeadProvisionalElements) {\n      document.head.appendChild(element)\n    }\n  }\n\n  activateNewBody() {\n    document.adoptNode(this.newElement)\n    this.activateNewBodyScriptElements()\n  }\n\n  activateNewBodyScriptElements() {\n    for (const inertScriptElement of this.newBodyScriptElements) {\n      const activatedScriptElement = this.createScriptElement(inertScriptElement)\n      inertScriptElement.replaceWith(activatedScriptElement)\n    }\n  }\n\n  assignNewBody() {\n    if (document.body && this.newElement instanceof HTMLBodyElement) {\n      document.body.replaceWith(this.newElement)\n    } else {\n      document.documentElement.appendChild(this.newElement)\n    }\n  }\n\n  get newHeadStylesheetElements() {\n    return this.newHeadSnapshot.getStylesheetElementsNotInSnapshot(this.currentHeadSnapshot)\n  }\n\n  get newHeadScriptElements() {\n    return this.newHeadSnapshot.getScriptElementsNotInSnapshot(this.currentHeadSnapshot)\n  }\n\n  get currentHeadProvisionalElements() {\n    return this.currentHeadSnapshot.provisionalElements\n  }\n\n  get newHeadProvisionalElements() {\n    return this.newHeadSnapshot.provisionalElements\n  }\n\n  get newBodyScriptElements() {\n    return [ ...this.newElement.querySelectorAll(\"script\") ]\n  }\n}\n","import { toCacheKey } from \"../url\"\nimport { PageSnapshot } from \"./page_snapshot\"\n\nexport class SnapshotCache {\n  readonly keys: string[] = []\n  readonly size: number\n  snapshots: { [url: string]: PageSnapshot } = {}\n\n  constructor(size: number) {\n    this.size = size\n  }\n\n  has(location: URL) {\n    return toCacheKey(location) in this.snapshots\n  }\n\n  get(location: URL): PageSnapshot | undefined {\n    if (this.has(location)) {\n      const snapshot = this.read(location)\n      this.touch(location)\n      return snapshot\n    }\n  }\n\n  put(location: URL, snapshot: PageSnapshot) {\n    this.write(location, snapshot)\n    this.touch(location)\n    return snapshot\n  }\n\n  clear() {\n    this.snapshots = {}\n  }\n\n  // Private\n\n  read(location: URL) {\n    return this.snapshots[toCacheKey(location)]\n  }\n\n  write(location: URL, snapshot: PageSnapshot) {\n    this.snapshots[toCacheKey(location)] = snapshot\n  }\n\n  touch(location: URL) {\n    const key = toCacheKey(location)\n    const index = this.keys.indexOf(key)\n    if (index > -1) this.keys.splice(index, 1)\n    this.keys.unshift(key)\n    this.trim()\n  }\n\n  trim() {\n    for (const key of this.keys.splice(this.size)) {\n      delete this.snapshots[key]\n    }\n  }\n}\n","import { nextEventLoopTick } from \"../../util\"\nimport { View, ViewDelegate } from \"../view\"\nimport { ErrorRenderer } from \"./error_renderer\"\nimport { PageRenderer } from \"./page_renderer\"\nimport { PageSnapshot } from \"./page_snapshot\"\nimport { SnapshotCache } from \"./snapshot_cache\"\n\nexport interface PageViewDelegate extends ViewDelegate<PageSnapshot> {\n  viewWillCacheSnapshot(): void\n}\n\ntype PageViewRenderer = PageRenderer | ErrorRenderer\n\nexport class PageView extends View<Element, PageSnapshot, PageViewRenderer, PageViewDelegate> {\n  readonly snapshotCache = new SnapshotCache(10)\n  lastRenderedLocation = new URL(location.href)\n\n  renderPage(snapshot: PageSnapshot, isPreview = false) {\n    const renderer = new PageRenderer(this.snapshot, snapshot, isPreview)\n    return this.render(renderer)\n  }\n\n  renderError(snapshot: PageSnapshot) {\n    const renderer = new ErrorRenderer(this.snapshot, snapshot, false)\n    this.render(renderer)\n  }\n\n  clearSnapshotCache() {\n    this.snapshotCache.clear()\n  }\n\n  async cacheSnapshot() {\n    if (this.shouldCacheSnapshot) {\n      this.delegate.viewWillCacheSnapshot()\n      const { snapshot, lastRenderedLocation: location } = this\n      await nextEventLoopTick()\n      this.snapshotCache.put(location, snapshot.clone())\n    }\n  }\n\n  getCachedSnapshotForLocation(location: URL) {\n    return this.snapshotCache.get(location)\n  }\n\n  get snapshot() {\n    return PageSnapshot.fromElement(this.element)\n  }\n\n  get shouldCacheSnapshot() {\n    return this.snapshot.isCacheable\n  }\n}\n","import { Adapter } from \"./native/adapter\"\nimport { BrowserAdapter } from \"./native/browser_adapter\"\nimport { FormSubmitObserver, FormSubmitObserverDelegate } from \"../observers/form_submit_observer\"\nimport { FrameRedirector } from \"./frames/frame_redirector\"\nimport { History, HistoryDelegate } from \"./drive/history\"\nimport { LinkClickObserver, LinkClickObserverDelegate } from \"../observers/link_click_observer\"\nimport { expandURL, isPrefixedBy, isHTML, Locatable } from \"./url\"\nimport { Navigator, NavigatorDelegate } from \"./drive/navigator\"\nimport { PageObserver, PageObserverDelegate } from \"../observers/page_observer\"\nimport { ScrollObserver } from \"../observers/scroll_observer\"\nimport { StreamMessage } from \"./streams/stream_message\"\nimport { StreamObserver } from \"../observers/stream_observer\"\nimport { Action, Position, StreamSource, isAction } from \"./types\"\nimport { dispatch } from \"../util\"\nimport { PageView, PageViewDelegate } from \"./drive/page_view\"\nimport { Visit, VisitOptions } from \"./drive/visit\"\nimport { PageSnapshot } from \"./drive/page_snapshot\"\n\nexport type TimingData = {}\n\nexport class Session implements FormSubmitObserverDelegate, HistoryDelegate, LinkClickObserverDelegate, NavigatorDelegate, PageObserverDelegate, PageViewDelegate {\n  readonly navigator = new Navigator(this)\n  readonly history = new History(this)\n  readonly view = new PageView(this, document.documentElement)\n  adapter: Adapter = new BrowserAdapter(this)\n\n  readonly pageObserver = new PageObserver(this)\n  readonly linkClickObserver = new LinkClickObserver(this)\n  readonly formSubmitObserver = new FormSubmitObserver(this)\n  readonly scrollObserver = new ScrollObserver(this)\n  readonly streamObserver = new StreamObserver(this)\n\n  readonly frameRedirector = new FrameRedirector(document.documentElement)\n\n  enabled = true\n  progressBarDelay = 500\n  started = false\n\n  start() {\n    if (!this.started) {\n      this.pageObserver.start()\n      this.linkClickObserver.start()\n      this.formSubmitObserver.start()\n      this.scrollObserver.start()\n      this.streamObserver.start()\n      this.frameRedirector.start()\n      this.history.start()\n      this.started = true\n      this.enabled = true\n    }\n  }\n\n  disable() {\n    this.enabled = false\n  }\n\n  stop() {\n    if (this.started) {\n      this.pageObserver.stop()\n      this.linkClickObserver.stop()\n      this.formSubmitObserver.stop()\n      this.scrollObserver.stop()\n      this.streamObserver.stop()\n      this.frameRedirector.stop()\n      this.history.stop()\n      this.started = false\n    }\n  }\n\n  registerAdapter(adapter: Adapter) {\n    this.adapter = adapter\n  }\n\n  visit(location: Locatable, options: Partial<VisitOptions> = {}) {\n    this.navigator.proposeVisit(expandURL(location), options)\n  }\n\n  connectStreamSource(source: StreamSource) {\n    this.streamObserver.connectStreamSource(source)\n  }\n\n  disconnectStreamSource(source: StreamSource) {\n    this.streamObserver.disconnectStreamSource(source)\n  }\n\n  renderStreamMessage(message: StreamMessage | string) {\n    document.documentElement.appendChild(StreamMessage.wrap(message).fragment)\n  }\n\n  clearCache() {\n    this.view.clearSnapshotCache()\n  }\n\n  setProgressBarDelay(delay: number) {\n    this.progressBarDelay = delay\n  }\n\n  get location() {\n    return this.history.location\n  }\n\n  get restorationIdentifier() {\n    return this.history.restorationIdentifier\n  }\n\n  // History delegate\n\n  historyPoppedToLocationWithRestorationIdentifier(location: URL) {\n    if (this.enabled) {\n      this.navigator.proposeVisit(location, { action: \"restore\", historyChanged: true })\n    } else {\n      this.adapter.pageInvalidated()\n    }\n  }\n\n  // Scroll observer delegate\n\n  scrollPositionChanged(position: Position) {\n    this.history.updateRestorationData({ scrollPosition: position })\n  }\n\n  // Link click observer delegate\n\n  willFollowLinkToLocation(link: Element, location: URL) {\n    return elementIsNavigable(link)\n      && this.locationIsVisitable(location)\n      && this.applicationAllowsFollowingLinkToLocation(link, location)\n  }\n\n  followedLinkToLocation(link: Element, location: URL) {\n    const action = this.getActionForLink(link)\n    this.visit(location.href, { action })\n  }\n\n  // Navigator delegate\n\n  allowsVisitingLocation(location: URL) {\n    return this.applicationAllowsVisitingLocation(location)\n  }\n\n  visitProposedToLocation(location: URL, options: Partial<VisitOptions>) {\n    extendURLWithDeprecatedProperties(location)\n    this.adapter.visitProposedToLocation(location, options)\n  }\n\n  visitStarted(visit: Visit) {\n    extendURLWithDeprecatedProperties(visit.location)\n    this.notifyApplicationAfterVisitingLocation(visit.location)\n  }\n\n  visitCompleted(visit: Visit) {\n    this.notifyApplicationAfterPageLoad(visit.getTimingMetrics())\n  }\n\n  // Form submit observer delegate\n\n  willSubmitForm(form: HTMLFormElement, submitter?: HTMLElement): boolean {\n    return elementIsNavigable(form) && elementIsNavigable(submitter)\n  }\n\n  formSubmitted(form: HTMLFormElement, submitter?: HTMLElement) {\n    this.navigator.submitForm(form, submitter)\n  }\n\n  // Page observer delegate\n\n  pageBecameInteractive() {\n    this.view.lastRenderedLocation = this.location\n    this.notifyApplicationAfterPageLoad()\n  }\n\n  pageLoaded() {\n    this.history.assumeControlOfScrollRestoration()\n  }\n\n  pageWillUnload() {\n    this.history.relinquishControlOfScrollRestoration()\n  }\n\n  // Stream observer delegate\n\n  receivedMessageFromStream(message: StreamMessage) {\n    this.renderStreamMessage(message)\n  }\n\n  // Page view delegate\n\n  viewWillCacheSnapshot() {\n    this.notifyApplicationBeforeCachingSnapshot()\n  }\n\n  viewWillRenderSnapshot({ element }: PageSnapshot, isPreview: boolean) {\n    this.notifyApplicationBeforeRender(element)\n  }\n\n  viewRenderedSnapshot(snapshot: PageSnapshot, isPreview: boolean) {\n    this.view.lastRenderedLocation = this.history.location\n    this.notifyApplicationAfterRender()\n  }\n\n  viewInvalidated() {\n    this.adapter.pageInvalidated()\n  }\n\n  // Application events\n\n  applicationAllowsFollowingLinkToLocation(link: Element, location: URL) {\n    const event = this.notifyApplicationAfterClickingLinkToLocation(link, location)\n    return !event.defaultPrevented\n  }\n\n  applicationAllowsVisitingLocation(location: URL) {\n    const event = this.notifyApplicationBeforeVisitingLocation(location)\n    return !event.defaultPrevented\n  }\n\n  notifyApplicationAfterClickingLinkToLocation(link: Element, location: URL) {\n    return dispatch(\"turbo:click\", { target: link, detail: { url: location.href }, cancelable: true })\n  }\n\n  notifyApplicationBeforeVisitingLocation(location: URL) {\n    return dispatch(\"turbo:before-visit\", { detail: { url: location.href }, cancelable: true })\n  }\n\n  notifyApplicationAfterVisitingLocation(location: URL) {\n    return dispatch(\"turbo:visit\", { detail: { url: location.href } })\n  }\n\n  notifyApplicationBeforeCachingSnapshot() {\n    return dispatch(\"turbo:before-cache\")\n  }\n\n  notifyApplicationBeforeRender(newBody: HTMLBodyElement) {\n    return dispatch(\"turbo:before-render\", { detail: { newBody }})\n  }\n\n  notifyApplicationAfterRender() {\n    return dispatch(\"turbo:render\")\n  }\n\n  notifyApplicationAfterPageLoad(timing: TimingData = {}) {\n    return dispatch(\"turbo:load\", { detail: { url: this.location.href, timing }})\n  }\n\n  // Private\n\n  getActionForLink(link: Element): Action {\n    const action = link.getAttribute(\"data-turbo-action\")\n    return isAction(action) ? action : \"advance\"\n  }\n\n  locationIsVisitable(location: URL) {\n    return isPrefixedBy(location, this.snapshot.rootLocation) && isHTML(location)\n  }\n\n  get snapshot() {\n    return this.view.snapshot\n  }\n}\n\nexport function elementIsNavigable(element?: Element) {\n  const container = element?.closest(\"[data-turbo]\")\n  if (container) {\n    return container.getAttribute(\"data-turbo\") != \"false\"\n  } else {\n    return true\n  }\n}\n\n// Older versions of the Turbo Native adapters referenced the\n// `Location#absoluteURL` property in their implementations of\n// the `Adapter#visitProposedToLocation()` and `#visitStarted()`\n// methods. The Location class has since been removed in favor\n// of the DOM URL API, and accordingly all Adapter methods now\n// receive URL objects.\n//\n// We alias #absoluteURL to #toString() here to avoid crashing\n// older adapters which do not expect URL objects. We should\n// consider removing this support at some point in the future.\n\nfunction extendURLWithDeprecatedProperties(url: URL) {\n  Object.defineProperties(url, deprecatedLocationPropertyDescriptors)\n}\n\nconst deprecatedLocationPropertyDescriptors = {\n  absoluteURL: {\n    get() {\n      return this.toString()\n    }\n  }\n}\n","import { FrameElement, FrameElementDelegate, FrameLoadingStyle } from \"../../elements/frame_element\"\nimport { FetchMethod, FetchRequest, FetchRequestDelegate, FetchRequestHeaders } from \"../../http/fetch_request\"\nimport { FetchResponse } from \"../../http/fetch_response\"\nimport { AppearanceObserver, AppearanceObserverDelegate } from \"../../observers/appearance_observer\"\nimport { parseHTMLDocument } from \"../../util\"\nimport { FormSubmission, FormSubmissionDelegate } from \"../drive/form_submission\"\nimport { Snapshot } from \"../snapshot\"\nimport { ViewDelegate } from \"../view\"\nimport { expandURL, urlsAreEqual, Locatable } from \"../url\"\nimport { FormInterceptor, FormInterceptorDelegate } from \"./form_interceptor\"\nimport { FrameView } from \"./frame_view\"\nimport { LinkInterceptor, LinkInterceptorDelegate } from \"./link_interceptor\"\nimport { FrameRenderer } from \"./frame_renderer\"\nimport { elementIsNavigable } from \"../session\"\n\nexport class FrameController implements AppearanceObserverDelegate, FetchRequestDelegate, FormInterceptorDelegate, FormSubmissionDelegate, FrameElementDelegate, LinkInterceptorDelegate, ViewDelegate<Snapshot<FrameElement>> {\n  readonly element: FrameElement\n  readonly view: FrameView\n  readonly appearanceObserver: AppearanceObserver\n  readonly linkInterceptor: LinkInterceptor\n  readonly formInterceptor: FormInterceptor\n  currentURL?: string\n  formSubmission?: FormSubmission\n  private resolveVisitPromise = () => {}\n  private connected = false\n  private hasBeenLoaded = false\n  private settingSourceURL = false\n\n  constructor(element: FrameElement) {\n    this.element = element\n    this.view = new FrameView(this, this.element)\n    this.appearanceObserver = new AppearanceObserver(this, this.element)\n    this.linkInterceptor = new LinkInterceptor(this, this.element)\n    this.formInterceptor = new FormInterceptor(this, this.element)\n  }\n\n  connect() {\n    if (!this.connected) {\n      this.connected = true\n      if (this.loadingStyle == FrameLoadingStyle.lazy) {\n        this.appearanceObserver.start()\n      }\n      this.linkInterceptor.start()\n      this.formInterceptor.start()\n      this.sourceURLChanged()\n    }\n  }\n\n  disconnect() {\n    if (this.connected) {\n      this.connected = false\n      this.appearanceObserver.stop()\n      this.linkInterceptor.stop()\n      this.formInterceptor.stop()\n    }\n  }\n\n  disabledChanged() {\n    if (this.loadingStyle == FrameLoadingStyle.eager) {\n      this.loadSourceURL()\n    }\n  }\n\n  sourceURLChanged() {\n    if (this.loadingStyle == FrameLoadingStyle.eager || this.hasBeenLoaded) {\n      this.loadSourceURL()\n    }\n  }\n\n  loadingStyleChanged() {\n    if (this.loadingStyle == FrameLoadingStyle.lazy) {\n      this.appearanceObserver.start()\n    } else {\n      this.appearanceObserver.stop()\n      this.loadSourceURL()\n    }\n  }\n\n  async loadSourceURL() {\n    if (!this.settingSourceURL && this.enabled && this.isActive && this.sourceURL != this.currentURL) {\n      const previousURL = this.currentURL\n      this.currentURL = this.sourceURL\n      if (this.sourceURL) {\n        try {\n          this.element.loaded = this.visit(this.sourceURL)\n          this.appearanceObserver.stop()\n          await this.element.loaded\n          this.hasBeenLoaded = true\n        } catch (error) {\n          this.currentURL = previousURL\n          throw error\n        }\n      }\n    }\n  }\n\n  async loadResponse(fetchResponse: FetchResponse) {\n    if (fetchResponse.redirected) {\n      this.sourceURL = fetchResponse.response.url\n    }\n\n    try {\n      const html = await fetchResponse.responseHTML\n      if (html) {\n        const { body } = parseHTMLDocument(html)\n        const snapshot = new Snapshot(await this.extractForeignFrameElement(body))\n        const renderer = new FrameRenderer(this.view.snapshot, snapshot, false)\n        await this.view.render(renderer)\n      }\n    } catch (error) {\n      console.error(error)\n      this.view.invalidate()\n    }\n  }\n\n  // Appearance observer delegate\n\n  elementAppearedInViewport(element: Element) {\n    this.loadSourceURL()\n  }\n\n  // Link interceptor delegate\n\n  shouldInterceptLinkClick(element: Element, url: string) {\n    return this.shouldInterceptNavigation(element)\n  }\n\n  linkClickIntercepted(element: Element, url: string) {\n    this.navigateFrame(element, url)\n  }\n\n  // Form interceptor delegate\n\n  shouldInterceptFormSubmission(element: HTMLFormElement, submitter?: Element) {\n    return this.shouldInterceptNavigation(element, submitter)\n  }\n\n  formSubmissionIntercepted(element: HTMLFormElement, submitter?: HTMLElement) {\n    if (this.formSubmission) {\n      this.formSubmission.stop()\n    }\n\n    this.formSubmission = new FormSubmission(this, element, submitter)\n    if (this.formSubmission.fetchRequest.isIdempotent) {\n      this.navigateFrame(element, this.formSubmission.fetchRequest.url.href)\n    } else {\n      const { fetchRequest } = this.formSubmission\n      this.prepareHeadersForRequest(fetchRequest.headers, fetchRequest)\n      this.formSubmission.start()\n    }\n  }\n\n  // Fetch request delegate\n\n  prepareHeadersForRequest(headers: FetchRequestHeaders, request: FetchRequest) {\n    headers[\"Turbo-Frame\"] = this.id\n  }\n\n  requestStarted(request: FetchRequest) {\n    this.element.setAttribute(\"busy\", \"\")\n  }\n\n  requestPreventedHandlingResponse(request: FetchRequest, response: FetchResponse) {\n    this.resolveVisitPromise()\n  }\n\n  async requestSucceededWithResponse(request: FetchRequest, response: FetchResponse) {\n    await this.loadResponse(response)\n    this.resolveVisitPromise()\n  }\n\n  requestFailedWithResponse(request: FetchRequest, response: FetchResponse) {\n    console.error(response)\n    this.resolveVisitPromise()\n  }\n\n  requestErrored(request: FetchRequest, error: Error) {\n    console.error(error)\n    this.resolveVisitPromise()\n  }\n\n  requestFinished(request: FetchRequest) {\n    this.element.removeAttribute(\"busy\")\n  }\n\n  // Form submission delegate\n\n  formSubmissionStarted(formSubmission: FormSubmission) {\n    const frame = this.findFrameElement(formSubmission.formElement)\n    frame.setAttribute(\"busy\", \"\")\n  }\n\n  formSubmissionSucceededWithResponse(formSubmission: FormSubmission, response: FetchResponse) {\n    const frame = this.findFrameElement(formSubmission.formElement)\n    frame.delegate.loadResponse(response)\n  }\n\n  formSubmissionFailedWithResponse(formSubmission: FormSubmission, fetchResponse: FetchResponse) {\n    this.element.delegate.loadResponse(fetchResponse)\n  }\n\n  formSubmissionErrored(formSubmission: FormSubmission, error: Error) {\n    console.error(error)\n  }\n\n  formSubmissionFinished(formSubmission: FormSubmission) {\n    const frame = this.findFrameElement(formSubmission.formElement)\n    frame.removeAttribute(\"busy\")\n  }\n\n  // View delegate\n\n  viewWillRenderSnapshot(snapshot: Snapshot, isPreview: boolean) {\n\n  }\n\n  viewRenderedSnapshot(snapshot: Snapshot, isPreview: boolean) {\n\n  }\n\n  viewInvalidated() {\n\n  }\n\n  // Private\n\n  private async visit(url: Locatable) {\n    const request = new FetchRequest(this, FetchMethod.get, expandURL(url))\n\n    return new Promise<void>(resolve => {\n      this.resolveVisitPromise = () => {\n        this.resolveVisitPromise = () => {}\n        resolve()\n      }\n      request.perform()\n    })\n  }\n\n  private navigateFrame(element: Element, url: string) {\n    const frame = this.findFrameElement(element)\n    frame.src = url\n  }\n\n  private findFrameElement(element: Element) {\n    const id = element.getAttribute(\"data-turbo-frame\") || this.element.getAttribute(\"target\")\n    return getFrameElementById(id) ?? this.element\n  }\n\n  async extractForeignFrameElement(container: ParentNode): Promise<FrameElement> {\n    let element\n    const id = CSS.escape(this.id)\n\n    try {\n      if (element = activateElement(container.querySelector(`turbo-frame#${id}`), this.currentURL)) {\n        return element\n      }\n\n      if (element = activateElement(container.querySelector(`turbo-frame[src][recurse~=${id}]`), this.currentURL)) {\n        await element.loaded\n        return await this.extractForeignFrameElement(element)\n      }\n\n      console.error(`Response has no matching <turbo-frame id=\"${id}\"> element`)\n    } catch (error) {\n      console.error(error)\n    }\n\n    return new FrameElement()\n  }\n\n  private shouldInterceptNavigation(element: Element, submitter?: Element) {\n    const id = element.getAttribute(\"data-turbo-frame\") || this.element.getAttribute(\"target\")\n\n    if (!this.enabled || id == \"_top\") {\n      return false\n    }\n\n    if (id) {\n      const frameElement = getFrameElementById(id)\n      if (frameElement) {\n        return !frameElement.disabled\n      }\n    }\n\n    if (!elementIsNavigable(element)) {\n      return false\n    }\n\n    if (submitter && !elementIsNavigable(submitter)) {\n      return false\n    }\n\n    return true\n  }\n\n  // Computed properties\n\n  get id() {\n    return this.element.id\n  }\n\n  get enabled() {\n    return !this.element.disabled\n  }\n\n  get sourceURL() {\n    if (this.element.src) {\n      return this.element.src\n    }\n  }\n\n  set sourceURL(sourceURL: string | undefined) {\n    this.settingSourceURL = true\n    this.element.src = sourceURL ?? null\n    this.settingSourceURL = false\n  }\n\n  get loadingStyle() {\n    return this.element.loading\n  }\n\n  get isLoading() {\n    return this.formSubmission !== undefined || this.resolveVisitPromise !== undefined\n  }\n\n  get isActive() {\n    return this.element.isActive && this.connected\n  }\n}\n\nfunction getFrameElementById(id: string | null) {\n  if (id != null) {\n    const element = document.getElementById(id)\n    if (element instanceof FrameElement) {\n      return element\n    }\n  }\n}\n\nfunction activateElement(element: Element | null, currentURL?: string) {\n  if (element) {\n    const src = element.getAttribute(\"src\")\n    if (src != null && currentURL != null && urlsAreEqual(src, currentURL)) {\n      throw new Error(`Matching <turbo-frame id=\"${element.id}\"> element has a source URL which references itself`)\n    }\n    if (element.ownerDocument !== document) {\n      element = document.importNode(element, true)\n    }\n\n    if (element instanceof FrameElement) {\n      element.connectedCallback()\n      return element\n    }\n  }\n}\n","import { StreamElement } from \"../../elements/stream_element\"\n\nexport const StreamActions: { [action: string]: (this: StreamElement) => void } = {\n  append() {\n    this.targetElement?.append(this.templateContent)\n  },\n\n  prepend() {\n    this.targetElement?.prepend(this.templateContent)\n  },\n\n  remove() {\n    this.targetElement?.remove()\n  },\n\n  replace() {\n    this.targetElement?.replaceWith(this.templateContent)\n  },\n\n  update() {\n    if (this.targetElement) {\n      this.targetElement.innerHTML = \"\"\n      this.targetElement.append(this.templateContent)\n    }\n  }\n}\n","import { StreamActions } from \"../core/streams/stream_actions\"\nimport { nextAnimationFrame } from \"../util\"\n\n// <turbo-stream action=replace target=id><template>...\n\nexport class StreamElement extends HTMLElement {\n  async connectedCallback() {\n    try {\n      await this.render()\n    } catch (error) {\n      console.error(error)\n    } finally {\n      this.disconnect()\n    }\n  }\n\n  private renderPromise?: Promise<void>\n\n  async render() {\n    return this.renderPromise ??= (async () => {\n      if (this.dispatchEvent(this.beforeRenderEvent)) {\n        await nextAnimationFrame()\n        this.performAction()\n      }\n    })()\n  }\n\n  disconnect() {\n    try { this.remove() } catch {}\n  }\n\n  get performAction() {\n    if (this.action) {\n      const actionFunction = StreamActions[this.action]\n      if (actionFunction) {\n        return actionFunction\n      }\n      this.raise(\"unknown action\")\n    }\n    this.raise(\"action attribute is missing\")\n  }\n\n  get targetElement() {\n    if (this.target) {\n      return this.ownerDocument?.getElementById(this.target)\n    }\n    this.raise(\"target attribute is missing\")\n  }\n\n  get templateContent() {\n    return this.templateElement.content\n  }\n\n  get templateElement() {\n    if (this.firstElementChild instanceof HTMLTemplateElement) {\n      return this.firstElementChild\n    }\n    this.raise(\"first child element must be a <template> element\")\n  }\n\n  get action() {\n    return this.getAttribute(\"action\")\n  }\n\n  get target() {\n    return this.getAttribute(\"target\")\n  }\n\n  private raise(message: string): never {\n    throw new Error(`${this.description}: ${message}`)\n  }\n\n  private get description() {\n    return (this.outerHTML.match(/<[^>]+>/) ?? [])[0] ?? \"<turbo-stream>\"\n  }\n\n  private get beforeRenderEvent() {\n    return new CustomEvent(\"turbo:before-stream-render\", { bubbles: true, cancelable: true })\n  }\n}\n","import { FrameController } from \"../core/frames/frame_controller\"\nimport { FrameElement } from \"./frame_element\"\nimport { StreamElement } from \"./stream_element\"\n\nFrameElement.delegateConstructor = FrameController\n\nexport * from \"./frame_element\"\nexport * from \"./stream_element\"\n\ncustomElements.define(\"turbo-frame\", FrameElement)\ncustomElements.define(\"turbo-stream\", StreamElement)\n","import { unindent } from \"./util\"\n\n(() => {\n  let element: Element | null = document.currentScript\n  if (!element) return\n  if (element.hasAttribute(\"data-turbo-suppress-warning\")) return\n\n  while (element = element.parentElement) {\n    if (element == document.body) {\n      return console.warn(unindent`\n        You are loading Turbo from a <script> element inside the <body> element. This is probably not what you meant to do!\n\n        Load your application’s JavaScript bundle inside the <head> element instead. <script> elements in <body> are evaluated with each page change.\n\n        For more information, see: https://turbo.hotwire.dev/handbook/building#working-with-script-elements\n\n        ——\n        Suppress this warning by adding a \"data-turbo-suppress-warning\" attribute to: %s\n      `, element.outerHTML)\n    }\n  }\n})()\n","import { Adapter } from \"./native/adapter\"\nimport { Session } from \"./session\"\nimport { Locatable } from \"./url\"\nimport { StreamMessage } from \"./streams/stream_message\"\nimport { StreamSource } from \"./types\"\nimport { VisitOptions } from \"./drive/visit\"\n\nconst session = new Session\nconst { navigator } = session\nexport { navigator }\n\nexport function start() {\n  session.start()\n}\n\nexport function registerAdapter(adapter: Adapter) {\n  session.registerAdapter(adapter)\n}\n\nexport function visit(location: Locatable, options?: Partial<VisitOptions>) {\n  session.visit(location, options)\n}\n\nexport function connectStreamSource(source: StreamSource) {\n  session.connectStreamSource(source)\n}\n\nexport function disconnectStreamSource(source: StreamSource) {\n  session.disconnectStreamSource(source)\n}\n\nexport function renderStreamMessage(message: StreamMessage | string) {\n  session.renderStreamMessage(message)\n}\n\nexport function clearCache() {\n  session.clearCache()\n}\n\nexport function setProgressBarDelay(delay: number) {\n  session.setProgressBarDelay(delay)\n}\n","import { Todo } from 'src/models/Todo'\nimport { Controller } from 'stimulus'\nimport { TodosToggleAllEvent } from '../todos'\n\n// Stimulus Controller for each Todo \nexport default class TodoController extends Controller {\n  // declare autocreated value properties for Typescript compiler\n  // TODO can we use values below and Typescript to make \n  // this less manual?\n  idValue: Number\n  hasIdValue: boolean\n\n  titleValue: String\n  hasTitleValue: boolean\n\n  completedValue: Boolean\n  hasCompletedValue: boolean\n\n  // expected values passed into controller\n  // TODO use Todo model?\n  static values = {\n    id: Number,\n    title: String,\n    completed: Boolean\n  }\n\n  completedTarget: HTMLInputElement\n  static targets = [\n    \"completed\"\n  ]\n\n  // declare classes that can be passed in. prob don't need \n  // the css classes but wanted to try out this Stimulus feature\n  editingClass: string\n  hasEditingClass: boolean\n  completedClass: string\n  hasCompletedClass: boolean\n  static classes = [\"editing\", \"completed\"]\n\n  // mark the todo as editing\n  edit() {\n    this.element.classList.add(this.editingClass);\n  }\n\n  toggleFromParent(event: TodosToggleAllEvent) {\n    // receive event from TodosController when toggle all\n    // event has been dispatched to update Todo to match\n    const newCompletedValue = event.detail.completed;\n    this.completedValue = newCompletedValue;\n    this.completedTarget.checked = newCompletedValue;\n    if (newCompletedValue) {\n      this.element.classList.add(this.completedClass);\n    } else {\n      this.element.classList.remove(this.completedClass);\n    }\n  }\n\n  // toggle todo complete\n  toggle() {\n    // apply css class for todo\n    const newCompletedValue = !this.completedValue;\n    if (newCompletedValue) {\n      this.element.classList.add(this.completedClass);\n    } else {\n      this.element.classList.remove(this.completedClass);\n    }\n\n    // tell the server to update the todo complete property\n    fetch(`/todo/${this.idValue}`, {\n      method: \"PATCH\",\n      headers: {\n        // tell server we accept turbo stream responses \n        Accept: \"text/vnd.turbo-stream.html\"\n      },\n      body: new URLSearchParams({\n        completed: newCompletedValue + \"\" // make boolean into a string\n      })\n    })\n      .then(response => response.text())\n      // update the todo element with the response\n      .then(html => this.element.innerHTML = html)\n\n    // dispatch completed property update to Todos controller\n    // TodosController can subscribe to this using\n    // data-action=\"todoCompletedToggled->todos#myAction\" on an\n    // parent DOM element\n    this.element.dispatchEvent(new TodoCompletedToggledEvent(newCompletedValue));\n\n  }\n\n}\n\nexport class TodoCompletedToggledEvent extends CustomEvent<{ completed: boolean }> {\n  constructor(completed: boolean) {\n    super(\"todoCompletedToggled\", {\n      detail: {\n        completed\n      },\n      bubbles: true // bubble event up the dom to parent\n    })\n  }\n}\n","import { Controller } from 'stimulus'\nimport { TodoCompletedToggledEvent } from '../todo'\n\n// Stimulus Controller containing all the Todos \nexport default class TodosController extends Controller {\n  // declarations of the target elements and existing properties\n  // to satisfy Typescript compiler\n  todoFormTarget: HTMLFormElement\n  todoInputTarget: HTMLInputElement\n  todoTargets: Element[]\n  footerTarget: Element\n  remainingCountTarget: Element\n  hasRemainingCountTarget: boolean\n  allFilterTarget: Element\n  activeFilterTarget: Element\n  completedFilterTarget: Element\n  toggleAllTarget: HTMLInputElement\n\n  static targets = [\n    \"todoInput\",\n    \"todoForm\",\n    \"todo\",\n    \"footer\",\n    \"remainingCount\",\n    \"allFilter\",\n    \"activeFilter\",\n    \"completedFilter\",\n    \"toggleAll\"\n  ]\n\n  // declarations for values for Typescript\n  remainingCountValue: number\n  hasRemainingCountValue: boolean\n\n  filterValue: String\n  hasFilterValue: boolean\n\n  static values = {\n    remainingCount: Number,\n    filter: String\n  }\n\n  // called when Enter key pressed on title input\n  clearOnEnter(event: KeyboardEvent) {\n    if (event.key === \"Enter\") {\n      const inputValue = this.todoInputTarget.value.trim();\n      if (inputValue.length === 0) {\n        // don't submit if input empty\n        event.preventDefault();\n      } else {\n        // tell server to create a new Todo\n        fetch(`/todo`, {\n          method: \"POST\",\n          headers: {\n            // tell server we accept turbo-stream responses\n            Accept: \"text/vnd.turbo-stream.html\"\n          },\n          body: new URLSearchParams({\n            title: this.todoInputTarget.value.trim()\n          })\n        })\n          .then(response => response.text())\n          .then(html => {\n            // add div to body to load turbo-stream response\n            // TODO better way to do this?\n            const d = document.createElement(\"div\");\n            d.innerHTML = html\n            document.body.append(d)\n\n            // update other controller targets / values\n            this.todoInputTarget.value = \"\";\n            this.footerTarget.classList.remove(\"hidden\");\n            this.remainingCountValue = this.remainingCountValue + 1;\n          })\n\n      }\n    }\n  }\n\n  toggleAll() {\n    const completed = this.toggleAllTarget.checked;\n\n    // dispatch event to toggle all Todo children elements to match\n    // completed value\n    this.todoTargets.forEach((t, i) => {\n      t.dispatchEvent(new TodosToggleAllEvent(completed))\n    })\n  }\n\n  // called when clear completed button pressed\n  clearCompleted(event: Event) {\n    event.preventDefault();\n\n    // find the completed Todos in the DOM\n    this.todoTargets.forEach((t, i) => {\n      let completed = t.getAttribute('data-todo-completed-value') === 'true'\n      if (completed) {\n        let id = t.getAttribute('data-todo-id-value')\n        // tell server to delete this Todo\n        fetch(`/todo/${id}`, {\n          method: \"DELETE\",\n          headers: {\n            // tell server we accept turbo-stream responses\n            Accept: \"text/vnd.turbo-stream.html\"\n          }\n        })\n          .then(response => response.text())\n          .then(html => {\n            // add div to body to load turbo-stream response\n            // TODO better way to do this?\n            const d = document.createElement(\"div\");\n            d.innerHTML = html\n            document.body.append(d)\n          })\n      }\n    })\n    this.countRemaining();\n  }\n\n  // counts the non-completed Todos and updates the remainingCountValue\n  // which kicks off the remainingCountValueChanged lifecycle method\n  countRemaining() {\n    var count = 0;\n    this.todoTargets.forEach((t, i) => {\n      let completed = t.getAttribute('data-todo-completed-value') === 'true'\n      if (!completed) {\n        count++;\n      }\n    })\n    this.remainingCountValue = count;\n  }\n\n  // make all Todos visiable\n  showAll(event: Event) {\n    event.preventDefault();\n    this.todoTargets.forEach((t, i) => {\n      t.classList.remove(\"hidden\")\n    })\n    this.filterValue = \"all\";\n  }\n\n  // only show non-completed Todos\n  showActive(event: Event) {\n    event.preventDefault();\n    this.todoTargets.forEach((t, i) => {\n      let completed = t.getAttribute('data-todo-completed-value') === 'true'\n      if (!completed) {\n        t.classList.remove(\"hidden\")\n      } else {\n        t.classList.add(\"hidden\")\n      }\n    })\n    this.filterValue = \"active\";\n  }\n\n  // only show completed Todos\n  showCompleted(event: Event) {\n    event.preventDefault();\n    this.todoTargets.forEach((t, i) => {\n      let completed = t.getAttribute('data-todo-completed-value') === 'true'\n      if (completed) {\n        t.classList.remove(\"hidden\")\n      } else {\n        t.classList.add(\"hidden\")\n      }\n    })\n    this.filterValue = \"completed\";\n  }\n\n  // automatically called by Stimulus when remainingCountValue is updated\n  remainingCountValueChanged() {\n    const count = this.remainingCountValue;\n    if (this.hasRemainingCountTarget) {\n      if (this.remainingCountValue > 0) {\n        this.footerTarget.classList.remove(\"hidden\");\n      } else {\n        this.footerTarget.classList.add(\"hidden\");\n      }\n      // update the remainingCount element\n      this.remainingCountTarget.innerHTML = `\n        <strong>${count}</strong> item${count === 1 ? '' : 's'} left\n      `\n    }\n\n  }\n\n  // automatically called by Stimulus when filterValue is updated\n  filterValueChanged() {\n    // mark the targets with css as approproiate\n    if (this.filterValue === \"all\") {\n      this.allFilterTarget.classList.add(\"selected\");\n      this.activeFilterTarget.classList.remove(\"selected\");\n      this.completedFilterTarget.classList.remove(\"selected\");\n    } else if (this.filterValue === \"active\") {\n      this.allFilterTarget.classList.remove(\"selected\");\n      this.activeFilterTarget.classList.add(\"selected\");\n      this.completedFilterTarget.classList.remove(\"selected\");\n    } else if (this.filterValue === \"completed\") {\n      this.allFilterTarget.classList.remove(\"selected\");\n      this.activeFilterTarget.classList.remove(\"selected\");\n      this.completedFilterTarget.classList.add(\"selected\");\n    }\n  }\n\n  updateRemainingCount(event: TodoCompletedToggledEvent) {\n    if (event.detail.completed) {\n      this.remainingCountValue = this.remainingCountValue - 1;\n    } else {\n      this.remainingCountValue = this.remainingCountValue + 1;\n    }\n  }\n\n}\n\nexport class TodosToggleAllEvent extends CustomEvent<{ completed: boolean }> {\n  constructor(completed: boolean) {\n    super(\"todosToggleAll\", {\n      detail: {\n        completed\n      },\n      bubbles: false // no need to bubble up since this is dispatched to children\n    })\n  }\n}","import { Application } from 'stimulus'\nimport * as Turbo from \"@hotwired/turbo\"\nimport TodoController from './todo';\nimport TodosController from './todos';\n\n// register the Stimulus Controllers\nconst application = Application.start()\napplication.register('todo', TodoController)\napplication.register('todos', TodosController)\n\n// add Turbo to the browser window\n// @ts-ignore\nwindow.Turbo = Turbo"]}